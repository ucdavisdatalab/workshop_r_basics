{
  "hash": "c915bd0c9f1213d3373501139753fac3",
  "result": {
    "engine": "knitr",
    "markdown": "# Exploring Data\n\n\n::: {.cell}\n\n:::\n\n\n:::{.callout-note}\n##### Learning Goals\n\nAfter completing this chapter, learners should be able to:\n\n* Describe when to use `[` versus `[[`\n* Index data frames to get specific rows, columns, or subsets\n* Install and load packages\n* Describe the grammar of graphics\n* Make a plot\n* Save a plot to an image file\n* Call a function repeatedly with `sapply` or `lapply`\n* Split data into groups and apply a function to each\n:::\n\nNow that you have a solid foundation in the basic functions and data structures\nof R, you can move on to its most popular application: data analysis. In this\nchapter, you'll learn how to efficiently explore and summarize data with\nvisualizations and statistics. Along the way, you'll also learn how to use\napply functions, which are essential to fluency in R.\n\n\n## Indexing Data Frames\n\nThis section explains how to get and set data in a data frame, expanding on the\nindexing techniques you learned in @sec-indexing. Under the hood, every data\nframe is a list, so first you'll learn about indexing lists.\n\n\n### Indexing Lists\n\nLists are a **container** for other types of R objects. When you select an\nelement from a list, you can either keep the container (the list) or discard\nit. The indexing operator `[` almost always keeps containers.\n\nAs an example, let's get some elements from a small list:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx = list(first = c(1, 2, 3), second = sin, third = c(\"hi\", \"hello\"))\ny = x[c(1, 3)]\ny\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$first\n[1] 1 2 3\n\n$third\n[1] \"hi\"    \"hello\"\n```\n\n\n:::\n\n```{.r .cell-code}\nclass(y)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"list\"\n```\n\n\n:::\n:::\n\n\nThe result is still a list. Even if we get just one element, the result of\nindexing a list with `[` is a list:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(x[1])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"list\"\n```\n\n\n:::\n:::\n\n\nSometimes this will be exactly what we want. But what if we want to get the\nfirst element of `x` so that we can use it in a vectorized function? Or in a\nfunction that only accepts numeric arguments? We need to somehow get the\nelement and discard the container.\n\nThe solution to this problem is the **extraction operator** `[[`, which is also\ncalled the double square bracket operator. The extraction operator is the\nprimary way to get and set elements of lists and other containers.\n\nUnlike the indexing operator `[`, the extraction operator always discards the\ncontainer:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx[[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1 2 3\n```\n\n\n:::\n\n```{.r .cell-code}\nclass(x[[1]])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"numeric\"\n```\n\n\n:::\n:::\n\n\nThe tradeoff is that the extraction operator can only get or set one element at\na time. Note that the element can be a vector, as above. Because it can only\nget or set one element at a time, the extraction operator can only index by\nposition or name. Blank and logical indexes are not allowed.\n\nThe final difference between the index operator `[` and the extraction operator\n`[[` has to do with how they handle invalid indexes. The index operator `[`\nreturns `NA` for invalid vector elements, and `NULL` for invalid list elements:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nc(1, 2)[10]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA\n```\n\n\n:::\n\n```{.r .cell-code}\nx[10]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$<NA>\nNULL\n```\n\n\n:::\n:::\n\n\nOn the other hand, the extraction operator `[[` raises an error for invalid\nelements:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx[[10]]\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in x[[10]]: subscript out of bounds\n```\n\n\n:::\n:::\n\n\nThe indexing operator `[` and the extraction operator `[[` both work with any\ndata structure that has elements. However, you'll generally use the indexing\noperator `[` to index vectors, and the extraction operator `[[` to index\ncontainers (such as lists).\n\n\n### Two-dimensional Indexing\n\nFor two-dimensional objects, like matrices and data frames, you can pass the\nindexing operator `[` or the extraction operator `[[` a separate index for each\ndimension. The rows come first:\n\n```\nDATA[ROWS, COLUMNS]\n```\n\nFor instance, let's get the first 3 rows and all columns of the least terns\ndata:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nterns[1:3, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  year             site_name   site_name_2013_2018   site_name_1988_2001\n1 2000 PITTSBURG POWER PLANT Pittsburg Power Plant  NA_2013_2018 POLYGON\n2 2000    ALBANY CENTRAL AVE         NA_NO POLYGON Albany Central Avenue\n3 2000         ALAMEDA POINT         Alameda Point  NA_2013_2018 POLYGON\n   site_abbr region_3 region_4   event bp_min bp_max fl_min fl_max total_nests\n1 PITT_POWER S.F._BAY S.F._BAY LA_NINA     15     15     16     18          15\n2 AL_CENTAVE S.F._BAY S.F._BAY LA_NINA      6     12      1      1          20\n3    ALAM_PT S.F._BAY S.F._BAY LA_NINA    282    301    200    230         312\n  nonpred_eggs nonpred_chicks nonpred_fl nonpred_ad pred_control pred_eggs\n1            3              0          0          0                      4\n2           NA             NA         NA         NA                     NA\n3          124             81          2          1                     17\n  pred_chicks pred_fl pred_ad pred_pefa pred_coy_fox pred_meso pred_owlspp\n1           2       0       0         N            N         N           N\n2          NA      NA      NA                                             \n3           0       0       0         N            N         N           N\n  pred_corvid pred_other_raptor pred_other_avian pred_misc total_pefa\n1           Y                 Y                N         N          0\n2                                                                  NA\n3           N                 Y                Y         N          0\n  total_coy_fox total_meso total_owlspp total_corvid total_other_raptor\n1             0          0            0            4                  2\n2            NA         NA           NA           NA                 NA\n3             0          0            0            0                  6\n  total_other_avian total_misc first_observed last_observed first_nest\n1                 0          0     2000-05-11    2000-08-05 2000-05-26\n2                NA         NA                                        \n3                11          0     2000-05-01    2000-08-19 2000-05-16\n  first_chick first_fledge\n1  2000-06-18   2000-07-08\n2                         \n3  2000-06-07   2000-06-30\n```\n\n\n:::\n:::\n\n\nAs we saw in @sec-all-elements, leaving an index blank means all elements.\n\nAs another example, let's get the 3rd and 5th row, and the 2nd and 4th column:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nterns[c(3, 5), c(2, 4)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                     site_name  site_name_1988_2001\n3                                ALAMEDA POINT NA_2013_2018 POLYGON\n5 OCEANO DUNES STATE VEHICULAR RECREATION AREA NA_2013_2018 POLYGON\n```\n\n\n:::\n:::\n\n\nMixing several different ways of indexing is allowed. So for example, we can\nget the same above, but use column names instead of positions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nterns[c(3, 5), c(\"year\", \"site_name\")]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  year                                    site_name\n3 2000                                ALAMEDA POINT\n5 2000 OCEANO DUNES STATE VEHICULAR RECREATION AREA\n```\n\n\n:::\n:::\n\n\nFor data frames, it's especially common to index the rows by condition and the\ncolumns by name. For instance, let's get the `site_name` and `bp_min` columns\nfor all year 2000 observations in the least terns data set:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresult = terns[terns$year == 2000, c(\"site_name\", \"bp_min\")]\nhead(result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                     site_name bp_min\n1                        PITTSBURG POWER PLANT     15\n2                           ALBANY CENTRAL AVE      6\n3                                ALAMEDA POINT    282\n4                               KETTLEMAN CITY      2\n5 OCEANO DUNES STATE VEHICULAR RECREATION AREA      4\n6              RANCHO GUADALUPE DUNES PRESERVE      9\n```\n\n\n:::\n:::\n\n\nAlso see @sec-the-drop-parameter for a case where the `[` operator behaves in a\nsurprising way.\n\n\n## Packages {#sec-packages}\n\nA **package** is a collection of functions for use in R. Packages usually\ninclude documentation, and can also contain examples, vignettes, and data sets.\nMost packages are developed by members of the R community, so quality varies.\nThere are also a few packages that are built into R but provide extra features.\nWe'll use a package in @sec-data-visualization, so we're learning about them\nnow.\n\nThe [Comprehensive R Archive Network][cran], or CRAN, is the main place people\npublish packages. As of writing, there were 18,619 packages posted to CRAN.\nThis number has been steadily increasing as R has grown in popularity.\n\n[cran]: https://cran.r-project.org/\n\nPackages span a wide variety of topics and disciplines. There are packages\nrelated to statistics, social sciences, geography, genetics, physics, biology,\npharmacology, economics, agriculture, and more. The best way to find packages\nis to search online, but the CRAN website also provides [\"task\nviews\"][cran-task-views] if you want to browse popular packages related to a\nspecific discipline.\n\n[cran-task-views]: https://cran.r-project.org/web/views/\n\nThe `install.packages` function installs one or more packages from CRAN. Its\nfirst argument is the packages to install, as a character vector.\n\nWhen you run `install.packages`, R will ask you to choose which **mirror** to\ndownload the package from. A mirror is a web server that has the same set of\nfiles as some other server. Mirrors are used to make downloads faster and to\nprovide redundancy so that if a server stops working, files are still available\nsomewhere else. CRAN has dozens of mirrors; you should choose one that's\ngeographically nearby, since that usually produces the best download speeds. If\nyou aren't sure which mirror to choose, you can use the 0-Cloud mirror, which\nattempts to automatically choose a mirror near you.\n\nAs an example, here's the code to install the remotes package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"remotes\")\n```\n:::\n\n\nIf you run the code above, you'll be asked to select a mirror, and then see\noutput that looks something like this:\n\n```\n--- Please select a CRAN mirror for use in this session ---\ntrying URL 'https://cloud.r-project.org/src/contrib/remotes_2.3.0.tar.gz'\nContent type 'application/x-gzip' length 148405 bytes (144 KB)\n==================================================\ndownloaded 144 KB\n\n* installing *source* package ‘remotes’ ...\n** package ‘remotes’ successfully unpacked and MD5 sums checked\n** using staged installation\n** R\n** inst\n** byte-compile and prepare package for lazy loading\n** help\n*** installing help indices\n** building package indices\n** installing vignettes\n** testing if installed package can be loaded from temporary location\n** testing if installed package can be loaded from final location\n** testing if installed package keeps a record of temporary installation path\n* DONE (remotes)\n\nThe downloaded source packages are in\n        ‘/tmp/Rtmp8t6iGa/downloaded_packages’\n```\n\nR goes through a variety of steps to install a package, even installing other\npackages that the package depends on. You can tell that a package installation\nsucceeded by the final line `DONE`. When a package installation fails, R prints\nan error message explaining the problem instead.\n\nOnce a package is installed, it stays on your computer until you remove it or\nremove R. This means you only need to install each package once. However, most\npackages are periodically updated. You can reinstall a package using\n`install.packages` the same way as above to get the latest version.\n\nAlternatively, you can update all of the R packages you have installed at once\nby calling the `update.packages` function. Beware that this may take a long\ntime if you have a lot of packages installed.\n\nThe function to remove packages is `remove.packages`. Like `install.packages`,\nthis function's first argument is the packages to remove, as a character\nvector.\n\nIf you want to see which packages are installed, you can use the\n`installed.packages` function. It does not require any arguments. It returns a\nmatrix with one row for each package and columns that contain a variety of\ninformation. Here's an example:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npackages = installed.packages()\n# Just print the version numbers for 10 packages.\npackages[1:10, \"Version\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      base  base64enc       boot      bslib     cachem      class        cli \n   \"4.5.1\"    \"0.1-3\"   \"1.3-32\"    \"0.9.0\"    \"1.1.0\"   \"7.3-23\"    \"3.6.5\" \n   cluster  codetools colorspace \n \"2.1.8.1\"   \"0.2-20\"    \"2.1-2\" \n```\n\n\n:::\n:::\n\n\nYou'll see a different set of packages, since you have a different computer.\n\nBefore you can use the functions (or other resources) in an installed package,\nyou must load the package with the `library` function. R doesn't load packages\nautomatically because each package you load uses memory and may conflict with\nother packages. Thus you should only load the packages you need for whatever\nit is that you want to do. When you restart R, the loaded packages are cleared\nand you must again load any packages you want to use.\n\nLet's load the remotes package we installed earlier:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"remotes\")\n```\n:::\n\n\nThe `library` function works with or without quotes around the package name, so\nyou may also see people write things like `library(remotes)`. We recommend\nusing quotes to make it unambiguous that you are not referring to a variable.\n\nA handful of packages print out a message when loaded, but the vast majority do\nnot. Thus you can assume the call to `library` was successful if nothing is\nprinted. If something goes wrong while loading a package, R will print out an\nerror message explaining the problem.\n\nFinally, not all R packages are published to CRAN. [GitHub][gh] is another\npopular place to publish R packages, especially ones that are experimental or\nstill in development. Unlike CRAN, GitHub is a general-purpose website for\npublishing code written in any programming language, so it contains much more\nthan just R packages and is not specifically R-focused.\n\n[gh]: https://github.com/\n\nThe remotes package that we just installed and loaded provides functions to\ninstall packages from GitHub. It is generally better to install packages from\nCRAN when they are available there, since the versions on CRAN tend to be more\nstable and intended for a wide audience. However, if you want to install a\npackage from GitHub, you can learn more about the remotes package by reading\nits [online documentation][remotes].\n\n[remotes]: https://remotes.r-lib.org/\n\n\n\n## Data Visualization {#sec-data-visualization}\n\nThere are three popular systems for creating visualizations in R:\n\n1. The base R functions (primarily the `plot` function)\n2. The lattice package\n3. The ggplot2 package\n\nThese three systems are not interoperable! Consequently, it's best to choose\none to use exclusively. Compared to base R, both lattice and ggplot2 are better\nat handling grouped data and generally require less code to create a\nnice-looking visualization.\n\nThe ggplot2 package is so popular that there are now knockoff packages for\nother data-science-oriented programming languages like Python and Julia. The\npackage is also part of the [Tidyverse][tidy], a popular collection of R\npackages designed to work well together. Because of these advantages, we'll use\nggplot2 for visualizations in this and all future lessons.\n\n[tidy]: https://www.tidyverse.org/\n\nggplot2 has detailed [documentation][ggplot2-docs] and also a\n[cheatsheet][ggplot2-cheat].\n\n[ggplot2-docs]: https://ggplot2.tidyverse.org/\n[ggplot2-cheat]: https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf\n\nThe \"gg\" in ggplot2 stands for **grammar of graphics**. The idea of a grammar\nof graphics is that visualizations can be built up in layers. In ggplot2, the\nthree layers every plot must have are:\n\n* Data\n* Geometry\n* Aesthetics\n\nThere are also several optional layers. Here are a few:\n\nLayer       | Description\n----------  | -----------\nscales      | Title, label, and axis value settings\nfacets      | Side-by-side plots\nguides      | Axis and legend position settings\nannotations | Shapes that are not mapped to data\ncoordinates | Coordinate systems (Cartesian, logarithmic, polar)\n\n\nLet's visualize the California least terns data set from @sec-ca-least-terns to\nsee how the grammar of graphics works in practice. But what kind of plot should\nwe make? It depends on what we want to know about the data set!\n\nSuppose we want to understand the relationship between the number of breeding\npairs and the total number of nests at each site, and whether this relationship\nis affected by climate events. One way to show the relationship between two\nnumerical features like these is to make a scatter plot.\n\n\n### Loading ggplot2\n\nBefore we can make the plot, we need to load ggplot2. As always, if this is\nyour first time using the package, you'll have to install it. Then you can load\nthe package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"ggplot2\")\nlibrary(\"ggplot2\")\n```\n:::\n\n\n### Layer 1: Data\n\nThe **data layer** determines the data set(s) used to make the plot.\n\nggplot2 and most other Tidyverse packages are designed to work with **tidy**\ndata, which means:\n\n1. Each feature has its own column.\n2. Each observation has its own row.\n3. Each value has its own cell.\n\nThese rules ensure data are easy to read visually and access with indexing. The\nleast terns data set satisfies all of these rules.\n\n:::{.callout-note title=\"See also\"}\nAll of the data sets we use in this reader are tidy. To learn how to tidy an\nuntidy data set, see the [Untidy & Relational Data][dl-r-tidy] chapter of\nDataLab's Intermediate R workshop reader.\n\n[dl-r-tidy]: https://ucdavisdatalab.github.io/workshop_intermediate_r/tidy-relational-data.html\n:::\n\nTo set up the data layer, call the `ggplot` function on a data frame:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns)\n```\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nThis returns a blank plot. We still need to add a few more layers.\n\n\n### Layer 2: Geometry\n\nThe **geometry layer** determines the shape or appearance of the visual\nelements of the plot. In other words, the geometry layer determines what kind\nof plot to make: one with points, lines, boxes, or something else.\n\nThere are many different geometries available in ggplot2. The package provides\na function for each geometry, always prefixed with `geom_`.\n\nTo add a geometry layer to the plot, choose the `geom_` function you want and\nadd it to the plot with the `+` operator. We'll use `geom_point`, which makes a\nscatter plot (a plot with points):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) + geom_point()\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in `geom_point()`:\n! Problem while setting up geom.\nℹ Error occurred in the 1st layer.\nCaused by error in `compute_geom_1()`:\n! `geom_point()` requires the following missing aesthetics: x and y.\n```\n\n\n:::\n:::\n\n\nThis returns an error message that we're missing aesthetics `x` and `y`. We'll\nlearn more about aesthetics in the next section, but this error message is\nespecially helpful: it tells us exactly what we're missing. When you use a\ngeometry you're unfamiliar with, it can be helpful to run the code for just the\ndata and geometry layer like this, to see exactly which aesthetics need to be\nset.\n\nAs we'll see later, it's possible to add multiple geometries to a plot.\n\n\n### Layer 3: Aesthetics\n\nThe **aesthetic layer** determines the relationship between the data and the\ngeometry. Use the aesthetic layer to map features in the data to aesthetics\n(visual elements) of the geometry.\n\nThe `aes` function creates an aesthetic layer. The syntax is:\n\n\n::: {.cell}\n\n```{.r .cell-code}\naes(AESTHETIC = FEATURE, ...)\n```\n:::\n\n\nThe names of the aesthetics depend on the geometry, but some common ones are\n`x`, `y`, `color`, `fill`, `shape`, and `size`. There is more information about\nand examples of aesthetic names in the documentation.\n\n\nFor the scatter plot of breeding pairs against total nests, we'll put `bp_min`\non the x-axis and `total_nests` on the y-axis. Below, we set both of these\naesthetics. We also enclose all of the code for the plot in parentheses `()` so\nthat we can put the code for each layer on a separate line, which makes the\nlayers easier to distinguish:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(x = bp_min, y = total_nests) +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n:::{.callout-important}\nIn the `aes` function, column names are never quoted.\n:::\n\n:::{.callout-note collapse=\"true\" title=\"Note: The Old Aesthetic Layer Syntax\"}\nIn older versions of ggplot2, you must pass the aesthetic layer as the second\nargument of the `ggplot` function rather than using `+` to add it to the plot.\nThis syntax is still widely used:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns, aes(x = bp_min, y = total_nests)) +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n:::\n\nAt this point, we've supplied all three layers necessary to make a plot: data,\ngeometry, and aesthetics. The plot shows what looks like a linear relationship\nbetween number of breeding pairs and total nests. To refine the plot, you can\nadd more layers and/or set parameters on the layers you have.\n\nLet's add another aesthetic to the plot: we'll make the color and shape of each\npoint correspond to `event`, the climate event for each observation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(x = bp_min, y = total_nests, color = event, shape = event) +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nUsing color and shape for the same feature is redundant, but ensures that the\nplot is accessible to colorblind people.\n\n\n#### Additional Geometries {-}\n\nEach observation in the least terns data corresponds to a specific year and\nsite. What if we label the points with their years? You can add text labels to\na plot with `geom_text`. The required aesthetic for this geometry is `label`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(\n    x = bp_min, y = total_nests,\n    color = event, shape = event,\n    label = year\n  ) +\n  geom_point() +\n  geom_text()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_text()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nThe labels make the plot more difficult to read and probably would even if we\nmade them smaller, because there are so many points on the plot. Making a\nhigh-quality visualization is typically a process of drafting and revising,\nsimilar to writing a high-quality essay. In this example, adding year labels to\nthe plot doesn't work well, so we'll backtrack and leave them off of the plot.\nIf accounting for year was critical to our research question, we could do it in\nother ways, such as by making separate plots for each year.\n\n#### Per-geometry Aesthetics {-}\n\nBefore we remove the labels, let's use them to demonstrate an important point\nabout using multiple geometry and aesthetic layers: when you add an aesthetic\nlayer to a plot, it applies to the entire plot. You can also set an aesthetic\nlayer for an individual geometry by passing the layer as the first argument in\nthe `geom_` function. Here's the same plot as above, but with the `color`\naesthetic only set for the labels:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(\n    x = bp_min, y = total_nests,\n    shape = event,\n    label = year\n  ) +\n  geom_point() +\n  geom_text(aes(color = event))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_text()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\nNotice that the points are no longer color-coded. Where you put aesthetic\nlayers matters.\n\n\n#### Constant Aesthetics {-}\n\nIf you want to set an aesthetic to a constant value, rather than one that's\ndata dependent, do so in the geometry layer rather than the aesthetic layer.\n\nFor instance, suppose we want to make all of the points blue and use only point\nshape to indicate climate events:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(\n    x = bp_min, y = total_nests,\n    shape = event\n  ) +\n  geom_point(color = \"blue\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nIf you set an aesthetic to a constant value inside of the aesthetic layer, the\nresults you get might not be what you expect:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(\n    x = bp_min, y = total_nests,\n    color = \"blue\", shape = event,\n    label = year\n  ) +\n  geom_point() +\n  geom_text()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_text()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n### Layer 4: Scales\n\nThe **scales layer** controls the title, axis labels, and axis scales of the\nplot. Most of the functions in the scales layer are prefixed with `scale_`, but\nnot all of them.\n\nThe `labs` function is especially important, because it's used to set the title\nand axis labels. Visualizations should generally have a title and axis labels,\nto aid the viewer:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(\n    x = bp_min, y = total_nests,\n    color = event, shape = event\n  ) +\n  geom_point() +\n  labs(\n    x = \"Minimum Reported Breeding Pairs\",\n    y = \"Total Nests\",\n    color = \"Climate Event\", shape = \"Climate Event\",\n    title = \"California Least Terns: Breeding Pairs vs. Nests\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nNotice that to set the title for a legend with `labs`, you can set the\nparameters of the same names as the corresponding aesthetics. While our plot is\nstill far from perfect---some of the points are hard to see because of how many\nthere are---it's now good enough to provide some insight into the relationship\nbetween number of breeding pairs and nests.\n\n\n### Saving Plots\n\nYou can use the `ggsave` function to save a plot you've assigned to a variable\nor the most recent plot you created (with no argument to `ggsave`):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"myplot.png\")\n```\n:::\n\n\nThe file format is selected automatically based on the extension. Common\nformats include PNG, TIFF, SVG, and PDF.\n\n:::{tip}\nPNG and SVG are good choices for sharing visualizations online, while TIFF and\nPDF are good choices for print. Many journals require that visualizations be in\nTIFF format.\n:::\n\n\n:::{.callout-note collapse=\"true\" title=\"Note: R Plot Devices\"}\nYou can also save a plot with one of R's \"plot device\" functions. The steps\nare:\n\n1. Call a plot device function: `png`, `jpeg`, `pdf`, `bmp`, `tiff`, or `svg`.\n2. Run your code to make the plot.\n3. Call `dev.off` to indicate that you're done plotting.\n\nThis strategy works with any of R's graphics systems (not just ggplot2).\n\nHere's an example:\n\n::: {.cell}\n\n```{.r .cell-code}\n# Run these lines in the console, not the notebook!\njpeg(\"myplot.jpeg\")\nggplot(terns) +\n  aes(\n    x = bp_min, y = total_nests,\n    color = event, shape = event\n  ) +\n  geom_point() +\n  labs(\n    x = \"Minimum Reported Breeding Pairs\",\n    y = \"Total Nests\",\n    color = \"Climate Event\", shape = \"Climate Event\",\n    title = \"California Least Terns: Breeding Pairs vs. Nests\"\n  )\ndev.off()\n```\n:::\n\n:::\n\n\n### Example: Bar Plot {#sec-example-bar-plot}\n\nSuppose we want to visualize how many fledglings there are each year, further\nbroken down by region. A bar plot is one appropriate way to represent this\nvisually.\n\nThe geometry for a bar plot is `geom_bar`. Since bar plots are mainly used to\ndisplay frequencies, by default the `geom_bar` function counts the number of\nobservations in each category on the x-axis and displays these counts on the\ny-axis. You can make `geom_bar` display values from a column on the y-axis by\nsetting the `weight` aesthetic:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(x = year, weight = fl_min, fill = region_3) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n:::{.callout-note collapse=\"true\" title=\"Note: Setting the Statistics Layer\"}\nEvery geometry layer has a corresponding statistics layer, which transforms\nfeature values into quantities to plot. For many geometries, the default\nstatistics layer is the only one that makes sense.\n\nBar plots are an exception. The default statistics layer is `stat_count`, which\ncounts observations. If you already have counts (or just want to display some\nquantities as bars), you need `stat_identity` (or the `weight` aesthetic\ndescribed above). Here's one way to change the statistics layer:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(terns) +\n  aes(x = year, y = fl_min, fill = region_3) +\n  geom_bar(stat = \"identity\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 12 rows containing missing values or values outside the scale range\n(`geom_bar()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nThis produces the same plot as setting `weight` and using the default\nstatistics layer `stat_count`.\n:::\n\nThe plot reveals that there are a few extraneous categories in the `region_3`\ncolumn: `ARIZONA`, `KINGS`, and `SACRAMENTO`. These might or might not be\nerroneous---and it would be good to investigate---but they don't add anything\nto this plot, so let's exclude them.\n\nLet's also change the **color map**, the palette of colors used for the\ncategories. These are both properties of the scale layer for the `fill`\naesthetic, so we'll use a `scale_fill_` function. In particular, we'll use the\n\"viridis\" color map, and since the fill color corresponds to categorical\n(discrete) data, we'll use `scale_fill_viridis_d`. We'll also add labels:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nterms_to_keep = c(\"S.F._BAY\", \"CENTRAL\", \"SOUTHERN\")\nterns_filtered = terns[terns$region_3 %in% terms_to_keep, ]\n\nggplot(terns_filtered) +\n  aes(x = year, weight = fl_min, fill = region_3) +\n  geom_bar() +\n  scale_fill_viridis_d() +\n  labs(\n    title = \"California Least Terns: Fledglings\",\n    x = \"Year\",\n    y = \"Minimum Reported Fledglings\",\n    fill = \"Region\"\n  )\n```\n\n::: {.cell-output-display}\n![](03_exploring-data_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\nYou can read more about the viridis color map in ggplot2's [documentation for\nthis function][gg-viridis]. The plot reveals that the data set is missing\n2001-2003 and that overall, fledgling counts seem to be declining in recent\nyears.\n\n[gg-viridis]: https://ggplot2.tidyverse.org/reference/scale_viridis.html\n\n:::{.callout-tip}\nThe setting `position = \"dodge\"` instructs `geom_bar` to put the bars\nside-by-side rather than stacking them.\n:::\n\n\n### Visualization Design\n\nDesigning high-quality visualizations goes beyond just mastering which R\nfunctions to call. You also need to think carefully about what kind of data you\nhave and what message you want to convey. This section provides a few\nguidelines.\n\nThe first step in data visualization is choosing an appropriate kind of plot.\nHere are some suggestions (not rules):\n\n| Feature 1   | Feature 2   | Plot\n| :---------- |:----------- |:----\n| categorical |             | bar, dot\n| categorical | categorical | bar, dot, mosaic\n| numerical   |             | box, density, histogram\n| numerical   | categorical | box, density, ridge\n| numerical   | numerical   | line, scatter, smooth scatter\n\nIf you want to add a:\n\n* 3rd numerical feature, use it to change point/line sizes.\n* 3rd categorical feature, use it to change point/line styles.\n* 4th categorical feature, use side-by-side plots.\n\nOnce you've selected a plot, here are some rules you should almost always\nfollow:\n\n* Always add a title and axis labels. These should be in plain English, not\n  variable names!\n\n* Specify units after the axis label if the axis has units. For instance,\n  \"Height (ft)\".\n\n* Don't forget that many people are colorblind! Also, plots are often printed\n  in black and white. Use point and line styles to distinguish groups; color is\n  optional.\n\n* Add a legend whenever you've used more than one point or line style.\n\n* Always write a few sentences explaining what the plot reveals. Don't\n  describe the plot, because the reader can just look at it. Instead,\n  explain what they can learn from the plot and point out important details\n  that are easily overlooked.\n\n* Sometimes points get plotted on top of each other. This is called\n  _overplotting_. Plots with a lot of overplotting can be hard to read and can\n  even misrepresent the data by hiding how many points are present. Use a\n  two-dimensional density plot or jitter the points to deal with overplotting.\n\n* For side-by-side plots, use the same axis scales for both plots so that\n  comparing them is not deceptive.\n\n:::{.callout-note title=\"See also\"}\nVisualization design is a deep topic, and whole books have been written about\nit. One resource where you can learn more is DataLab's [Principles of Data\nVisualization Workshop Reader][dataviz].\n\n[dataviz]: https://ucdavisdatalab.github.io/workshop_data_viz_principles/\n:::\n\n\n## Apply Functions\n\n@sec-vectorization introduced vectorization, a convenient and efficient way to\ncompute multiple results. That section also mentioned that some of R's\nfunctions---the ones that summarize or aggregate data---are not vectorized.\n\nThe `class` function is an example of a function that's not vectorized. If we\ncall the `class` function on the least terns data set, we get just one result\nfor the data set as a whole:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(terns)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"data.frame\"\n```\n\n\n:::\n:::\n\n\nWhat if we want to get the class of each column? We can get the class for a\nsingle column by selecting the column with `$`, the dollar sign operator:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(terns$year)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"integer\"\n```\n\n\n:::\n:::\n\n\nBut what if we want the classes for all the columns? We could write a call to\n`class` for each column, but that would be tedious. When you're working with a\nprogramming language, you should try to avoid tedium; there's usually a better,\nmore automated way.\n\n@sec-lists pointed out that data frames are technically lists, where each\ncolumn is one element. With that in mind, what we need here is a line of code\nthat calls `class` on each element of the data frame. The idea is similar to\nvectorization, but since we have a list and a non-vectorized function, we have\nto do a bit more than just call `class(terns)`.\n\nThe `lapply` function calls, or _applies_, a function on each element of a list\nor vector. The syntax is:\n\n```\nlapply(X, FUN, ...)\n```\n\nThe function `FUN` is called once for each element of `X`, with the element as\nthe first argument. The `...` is for additional arguments to `FUN`, which are\nheld constant across all the elements.\n\nLet's try this out with the least terns data and the `class` function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlapply(terns, class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$year\n[1] \"integer\"\n\n$site_name\n[1] \"character\"\n\n$site_name_2013_2018\n[1] \"character\"\n\n$site_name_1988_2001\n[1] \"character\"\n\n$site_abbr\n[1] \"character\"\n\n$region_3\n[1] \"character\"\n\n$region_4\n[1] \"character\"\n\n$event\n[1] \"character\"\n\n$bp_min\n[1] \"numeric\"\n\n$bp_max\n[1] \"numeric\"\n\n$fl_min\n[1] \"integer\"\n\n$fl_max\n[1] \"integer\"\n\n$total_nests\n[1] \"integer\"\n\n$nonpred_eggs\n[1] \"integer\"\n\n$nonpred_chicks\n[1] \"integer\"\n\n$nonpred_fl\n[1] \"integer\"\n\n$nonpred_ad\n[1] \"integer\"\n\n$pred_control\n[1] \"character\"\n\n$pred_eggs\n[1] \"integer\"\n\n$pred_chicks\n[1] \"integer\"\n\n$pred_fl\n[1] \"integer\"\n\n$pred_ad\n[1] \"integer\"\n\n$pred_pefa\n[1] \"character\"\n\n$pred_coy_fox\n[1] \"character\"\n\n$pred_meso\n[1] \"character\"\n\n$pred_owlspp\n[1] \"character\"\n\n$pred_corvid\n[1] \"character\"\n\n$pred_other_raptor\n[1] \"character\"\n\n$pred_other_avian\n[1] \"character\"\n\n$pred_misc\n[1] \"character\"\n\n$total_pefa\n[1] \"integer\"\n\n$total_coy_fox\n[1] \"integer\"\n\n$total_meso\n[1] \"integer\"\n\n$total_owlspp\n[1] \"integer\"\n\n$total_corvid\n[1] \"integer\"\n\n$total_other_raptor\n[1] \"integer\"\n\n$total_other_avian\n[1] \"integer\"\n\n$total_misc\n[1] \"integer\"\n\n$first_observed\n[1] \"character\"\n\n$last_observed\n[1] \"character\"\n\n$first_nest\n[1] \"character\"\n\n$first_chick\n[1] \"character\"\n\n$first_fledge\n[1] \"character\"\n```\n\n\n:::\n:::\n\n\nThe result is similar to if the `class` function was vectorized. In fact, if we\nuse a vector and a vectorized function with `lapply`, the result is nearly\nidentical to the result from vectorization:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx = c(1, 2, pi)\n\nsin(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8.414710e-01 9.092974e-01 1.224647e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nlapply(x, sin)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n[1] 0.841471\n\n[[2]]\n[1] 0.9092974\n\n[[3]]\n[1] 1.224647e-16\n```\n\n\n:::\n:::\n\n\nThe only difference is that the result from `lapply` is a list. In fact, the\n`lapply` function always returns a list with one element for each element of\nthe input data. The \"l\" in `lapply` stands for \"list\".\n\nThe `lapply` function is one member of a family of functions called **apply\nfunctions**. All of the apply functions provide ways to apply a function\nrepeatedly to different parts of a data structure. We'll meet a few more apply\nfunctions soon.\n\nWhen you have a choice between using vectorization or an apply function, you\nshould always choose vectorization. Vectorization is clearer---compare the two\nlines of code above---and it's also significantly more efficient. In fact,\nvectorization is the most efficient way to call a function repeatedly in R.\n\nAs we saw with the `class` function, there are some situations where\nvectorization is not possible. That's when you should think about using an\napply function.\n\n\n### The `sapply` Function\n\nThe related `sapply` function calls a function on each element of a list or\nvector, and simplifies the result. That last part is the crucial difference\ncompared to `lapply`. When results from the calls all have the same type and\nlength, `sapply` returns a vector or matrix instead of a list. When the results\nhave different types or lengths, the result is the same as for `lapply`. The\n\"s\" in `sapply` stands for \"simplify\".\n\nFor instance, if we use `sapply` to find the classes of the columns in the\nleast terns data, we get a character vector:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(terns, class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               year           site_name site_name_2013_2018 site_name_1988_2001 \n          \"integer\"         \"character\"         \"character\"         \"character\" \n          site_abbr            region_3            region_4               event \n        \"character\"         \"character\"         \"character\"         \"character\" \n             bp_min              bp_max              fl_min              fl_max \n          \"numeric\"           \"numeric\"           \"integer\"           \"integer\" \n        total_nests        nonpred_eggs      nonpred_chicks          nonpred_fl \n          \"integer\"           \"integer\"           \"integer\"           \"integer\" \n         nonpred_ad        pred_control           pred_eggs         pred_chicks \n          \"integer\"         \"character\"           \"integer\"           \"integer\" \n            pred_fl             pred_ad           pred_pefa        pred_coy_fox \n          \"integer\"           \"integer\"         \"character\"         \"character\" \n          pred_meso         pred_owlspp         pred_corvid   pred_other_raptor \n        \"character\"         \"character\"         \"character\"         \"character\" \n   pred_other_avian           pred_misc          total_pefa       total_coy_fox \n        \"character\"         \"character\"           \"integer\"           \"integer\" \n         total_meso        total_owlspp        total_corvid  total_other_raptor \n          \"integer\"           \"integer\"           \"integer\"           \"integer\" \n  total_other_avian          total_misc      first_observed       last_observed \n          \"integer\"           \"integer\"         \"character\"         \"character\" \n         first_nest         first_chick        first_fledge \n        \"character\"         \"character\"         \"character\" \n```\n\n\n:::\n:::\n\n\nLikewise, if we use `sapply` to compute the `sin` values, we get a numeric\nvector, the same as from vectorization:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(x, sin)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8.414710e-01 9.092974e-01 1.224647e-16\n```\n\n\n:::\n:::\n\n\nIn spite of that, vectorization is still more efficient than `sapply`, so use\nvectorization instead when possible.\n\nApply functions are incredibly useful for summarizing data. For example,\nsuppose we want to compute the frequencies for all of the columns in the\nleast terns data set that aren't numeric.\n\nFirst, we need to identify the columns. One way to do this is with the\n`is.numeric` function. Despite the name, this function actually tests whether\nits argument is a real number, not whether it its argument is a numeric vector.\nIn other words, it also returns true for integer values. We can use `sapply` to\napply this function to all of the columns in the least terns data set:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nis_not_number = !sapply(terns, is.numeric)\nis_not_number\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               year           site_name site_name_2013_2018 site_name_1988_2001 \n              FALSE                TRUE                TRUE                TRUE \n          site_abbr            region_3            region_4               event \n               TRUE                TRUE                TRUE                TRUE \n             bp_min              bp_max              fl_min              fl_max \n              FALSE               FALSE               FALSE               FALSE \n        total_nests        nonpred_eggs      nonpred_chicks          nonpred_fl \n              FALSE               FALSE               FALSE               FALSE \n         nonpred_ad        pred_control           pred_eggs         pred_chicks \n              FALSE                TRUE               FALSE               FALSE \n            pred_fl             pred_ad           pred_pefa        pred_coy_fox \n              FALSE               FALSE                TRUE                TRUE \n          pred_meso         pred_owlspp         pred_corvid   pred_other_raptor \n               TRUE                TRUE                TRUE                TRUE \n   pred_other_avian           pred_misc          total_pefa       total_coy_fox \n               TRUE                TRUE               FALSE               FALSE \n         total_meso        total_owlspp        total_corvid  total_other_raptor \n              FALSE               FALSE               FALSE               FALSE \n  total_other_avian          total_misc      first_observed       last_observed \n              FALSE               FALSE                TRUE                TRUE \n         first_nest         first_chick        first_fledge \n               TRUE                TRUE                TRUE \n```\n\n\n:::\n:::\n\n\nIs it worth using R code to identify the non-numeric columns? Since there are\nonly 43 columns in the least terns data set, maybe not. But if the\ndata set was larger, with say 100 columns, it definitely would be.\n\nIn general, it's a good habit to use R to do things rather than do them\nmanually. You'll get more practice programming, and your code will be more\nflexible if you want to adapt it to other data sets.\n\nNow that we know which columns are non-numeric, we can use the `table` function\nto compute frequencies. We only want to compute frequencies for those columns,\nso we need to subset the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlapply(terns[, is_not_number], table)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$site_name\n\n                               ALAMEDA POINT \n                                          21 \n                          ALBANY CENTRAL AVE \n                                           2 \n                                ANAHEIM LAKE \n                                           3 \n                            ARIZONA GLENDALE \n                                           1 \n        BATIQUITOS LAGOON ECOLOGICAL RESERVE \n                                          21 \n              BOLSA CHICA ECOLOGICAL RESERVE \n                                          21 \n                               BURRIS ISLAND \n                                          18 \n                CHULA VISTA WILDLIFE RESERVE \n                                          21 \n                      COAL OIL POINT RESERVE \n                                          14 \n           DSTREET FILL SWEETWATER MARSH NWR \n                                          21 \n             EDEN LANDING ECOLOGICAL RESERVE \n                                          17 \n                             FAIRBANKS RANCH \n                                           9 \n                  GUADALUPE NIPOMO DUNES NWR \n                                           1 \n                  HAYWARD REGIONAL SHORELINE \n                                          19 \n                             HOLLYWOOD BEACH \n                                          18 \n                      HUNTINGTON STATE BEACH \n                                          21 \n                              KETTLEMAN CITY \n                                          15 \n                                   LA HARBOR \n                                          21 \n                               MALIBU LAGOON \n                                           7 \n                          MCB CAMP PENDLETON \n                                          21 \n                      MISSION BAY FAA ISLAND \n                                          21 \n                  MISSION BAY MARINERS POINT \n                                          21 \n             MISSION BAY NORTH FIESTA ISLAND \n                                          21 \n           MISSION BAY SAN DIEGO RIVER MOUTH \n                                          14 \n                     MISSION BAY STONY POINT \n                                          18 \n                          MONTEZUMA WETLANDS \n                                          18 \n             NAPA SONOMA MARSH WILDLIFE AREA \n                                          17 \n                            NAS NORTH ISLAND \n                                          21 \n              NAVAL AMPHIBIOUS BASE CORONADO \n                                          21 \n                             NBVC POINT MUGU \n                                          21 \nOCEANO DUNES STATE VEHICULAR RECREATION AREA \n                                          21 \n                                ORMOND BEACH \n                                          21 \n                       PITTSBURG POWER PLANT \n                                          15 \n             RANCHO GUADALUPE DUNES PRESERVE \n                                          20 \n                      SACRAMENTO BUFFERLANDS \n                                          10 \n                                  SALTON SEA \n                                           7 \n      SAN DIEGUITO LAGOON ECOLOGICAL RESERVE \n                                          10 \n         SAN ELIJO LAGOON ECOLOGICAL RESERVE \n                                          21 \n                           SAN PABLO BAY NWR \n                                           3 \n       SANTA CLARA RIVER MCGRATH STATE BEACH \n                                          21 \n  SATICOY UNITED WATER CONSERVATION DISTRICT \n                                           9 \n                        SDIA LINDBERGH FIELD \n                                          21 \n                  SEAL BEACH NWR ANAHEIM BAY \n                                          21 \n                   SILVER STRAND STATE BEACH \n                                           1 \n    SOUTH SAN DIEGO BAY UNIT SDNWR SALTWORKS \n                                          21 \n                        TIJUANA ESTUARY NERR \n                                          21 \n        UPPER NEWPORT BAY ECOLOGICAL RESERVE \n                                          21 \n                              VANDENBERG SFB \n                                          21 \n                                VENICE BEACH \n                                          21 \n\n$site_name_2013_2018\n\n                                                          \n                                                        3 \n                                            Alameda Point \n                                                       21 \n                                             Anaheim Lake \n                                                        3 \n                                        Batiquitos Lagoon \n                                                       21 \n                                              Bolsa Chica \n                                                       21 \n                                              Bufferlands \n                                                       10 \n                                             Burris Basin \n                                                       18 \n                                           Camp Pendleton \n                                                       21 \n                              Chula Vista Wildlife Refuge \n                                                       21 \n                                   Coal Oil Point Reserve \n                                                       14 \n                                            D Street Fill \n                                                       21 \n                          Eden Landing Ecological Reserve \n                                                       17 \n                                               FAA Island \n                                                       21 \n                                          Fairbanks Ranch \n                                                        9 \n                               Hayward Regional Shoreline \n                                                       19 \n                                          Hollywood Beach \n                                                       18 \n                              Huntington Beach State Park \n                                                       21 \n                                                Kettleman \n                                                       15 \n             Lindbergh Field/Former Naval Training Center \n                                                       21 \n                                            Malibu Lagoon \n                                                        7 \n                                          Mariner's Point \n                                                       21 \n                                                Montezuma \n                                                       18 \n                                            NA_NO POLYGON \n                                                        5 \nNapa Sonoma Marsh Wildlife Area Huichica Unit (Pond 7/7A) \n                                                       17 \n                                      Naval Base Coronado \n                                                       42 \n                                          NBVC Point Mugu \n                                                       21 \n                                      North Fiesta Island \n                                                       21 \n             Oceano Dunes State Vehicular Recreation Area \n                                                       21 \n                                             Ormond Beach \n                                                       21 \n                                    Pittsburg Power Plant \n                                                       15 \n                                               Port of LA \n                                                       21 \n                          Rancho Guadalupe Dunes Preserve \n                                                       20 \n                                               Salton Sea \n                                                        7 \n                                                Saltworks \n                                                       21 \n                                    San Diego River Mouth \n                                                       14 \n                                      San Diequito Lagoon \n                                                       10 \n                                         San Elijo Lagoon \n                                                       21 \n                                        Santa Clara River \n                                                       21 \n               Saticoy United Water Conservation District \n                                                        9 \n                      Seal Beach National Wildlife Refuge \n                                                       21 \n                                              Stony Point \n                                                       18 \n                                          Tijuana Estuary \n                                                       21 \n                                        Upper Newport Bay \n                                                       21 \n                                           Vandenberg AFB \n                                                       21 \n                                             Venice Beach \n                                                       21 \n\n$site_name_1988_2001\n\n                      Albany Central Avenue  NA_2013_2018 POLYGON \n                    3                     2                   783 \n        NA_NO POLYGON \n                    3 \n\n$site_abbr\n\n  AL_CENTAVE      ALAM_PT       ANA_LK     ARZ_GLEN         BCER         BLER \n           2           21            3            1           21           21 \n     BUR_ISL     COAL_OIL           CV         D_ST         ELER     FAIR_RAN \n          18           14           21           21           17            9 \n     GND_NWR HAY_REG_SHOR           HB          HSB      KET_CTY      LA_HARB \n           1           19           18           21           15           21 \n     MAL_LAG       MB_FAA    MB_MAR_PT       MB_NFI   MB_SDRIV_S     MB_STONY \n           7           21           21           21           14           18 \n       MCBCP         MONT          NAB        NASNI        NSMWA OCEANO_DUNES \n          21           18           21           21           17           21 \n      ORMOND   PITT_POWER      PT_MUGU         RGDP   S_CLAR_MCG      SAC_BUF \n          21           15           21           20           21           10 \n        SALT     SALT_SEA    SAN_ELIJO SANDIEGU_LAG      SAT_WCD      SDIA_LF \n          21            7           21           10            9           21 \nSEAL_BCH_NWR     SLVRSTRD       SPBNWR       TJ_RIV        UNBER      VAN_SFB \n          21            1            3           21           21           21 \n     VEN_BCH \n          21 \n\n$region_3\n\n   ARIZONA    CENTRAL      KINGS   S.F._BAY SACRAMENTO   SOUTHERN \n         1         77         15        112         10        576 \n\n$region_4\n\n   ARIZONA    CENTRAL      KINGS   S.F._BAY SACRAMENTO   SOUTHERN    VENTURA \n         1         77         15        112         10        486         90 \n\n$event\n\nEL_NINO LA_NINA NEUTRAL \n    120     258     413 \n\n$pred_control\n\n      N   Y \n342 134 315 \n\n$pred_pefa\n\n      N   Y \n143 423 225 \n\n$pred_coy_fox\n\n      N   Y \n142 535 114 \n\n$pred_meso\n\n      N   Y \n142 552  97 \n\n$pred_owlspp\n\n      N   Y \n142 531 118 \n\n$pred_corvid\n\n      N   Y \n142 423 226 \n\n$pred_other_raptor\n\n      N  NN   Y \n145 437   1 208 \n\n$pred_other_avian\n\n      N   Y \n143 395 253 \n\n$pred_misc\n\n      N   Y \n159 415 217 \n\n$first_observed\n\n           2000-04-16 2000-04-19 2000-04-21 2000-04-22 2000-04-23 2000-04-26 \n       141          1          1          1          1          1          1 \n2000-04-28 2000-05-01 2000-05-04 2000-05-06 2000-05-07 2000-05-09 2000-05-11 \n         5          1          3          1          2          1          1 \n2000-05-21 2000-06-06 2000-06-10 2004-04-08 2004-04-11 2004-04-12 2004-04-21 \n         1          1          1          1          1          2          1 \n2004-04-22 2004-04-23 2004-04-27 2004-04-30 2004-05-01 2004-05-03 2004-05-07 \n         2          1          1          1          1          2          1 \n2004-05-09 2004-05-10 2004-05-14 2004-05-17 2004-05-31 2004-06-03 2005-04-14 \n         1          1          1          1          1          1          1 \n2005-04-15 2005-04-18 2005-04-19 2005-04-20 2005-04-21 2005-04-22 2005-04-23 \n         1          2          1          2          2          1          2 \n2005-04-24 2005-04-28 2005-04-29 2005-04-30 2005-05-01 2005-05-05 2005-05-07 \n         1          2          1          1          1          1          1 \n2005-05-08 2005-05-10 2005-05-13 2005-05-27 2005-05-28 2006-04-08 2006-04-10 \n         1          1          1          1          1          2          1 \n2006-04-13 2006-04-15 2006-04-16 2006-04-20 2006-04-22 2006-04-27 2006-04-28 \n         1          1          1          1          3          1          1 \n2006-05-01 2006-05-03 2006-05-08 2006-05-10 2006-05-14 2006-05-15 2006-05-20 \n         1          2          1          1          2          1          1 \n2006-06-23 2006-06-24 2007-04-16 2007-04-18 2007-04-22 2007-04-23 2007-04-24 \n         1          1          1          1          1          1          2 \n2007-04-25 2007-04-26 2007-04-28 2007-05-01 2007-05-02 2007-05-03 2007-05-11 \n         4          2          1          3          3          1          1 \n2007-05-13 2007-05-14 2007-05-18 2007-05-24 2007-06-02 2007-06-06 2007-06-08 \n         2          1          1          1          1          1          1 \n2008-04-11 2008-04-16 2008-04-23 2008-04-24 2008-04-25 2008-04-27 2008-04-28 \n         1          2          1          4          1          3          3 \n2008-05-01 2008-05-04 2008-05-05 2008-05-07 2008-05-08 2008-05-09 2008-05-12 \n         1          1          1          1          1          2          1 \n2008-05-14 2008-05-15 2008-05-21 2008-05-22 2008-05-24 2008-05-28 2008-05-31 \n         1          1          1          1          1          1          1 \n2009-04-16 2009-04-19 2009-04-22 2009-04-23 2009-04-24 2009-04-25 2009-04-26 \n         2          1          1          4          2          1          3 \n2009-04-29 2009-04-30 2009-05-02 2009-05-03 2009-05-04 2009-05-05 2009-05-06 \n         1          1          1          2          1          1          1 \n2009-05-08 2009-05-11 2009-05-13 2009-05-28 2010-04-14 2010-04-16 2010-04-17 \n         3          1          2          1          1          2          1 \n2010-04-18 2010-04-19 2010-04-21 2010-04-22 2010-04-25 2010-04-27 2010-04-28 \n         2          1          1          2          2          1          1 \n2010-04-29 2010-05-01 2010-05-02 2010-05-04 2010-05-06 2010-05-07 2010-05-13 \n         1          1          1          1          1          1          2 \n2010-05-14 2010-05-15 2010-05-16 2010-05-26 2010-05-29 2010-05-30 2010-06-09 \n         2          4          1          1          1          1          1 \n2011-04-09 2011-04-15 2011-04-18 2011-04-20 2011-04-21 2011-04-22 2011-04-24 \n         1          1          1          1          5          2          1 \n2011-04-25 2011-04-27 2011-04-28 2011-04-29 2011-05-01 2011-05-04 2011-05-05 \n         1          1          1          1          1          1          2 \n2011-05-07 2011-05-08 2011-05-11 2011-05-12 2011-05-14 2011-05-28 2011-06-11 \n         1          1          1          1          3          1          1 \n2011-06-14 2011-06-25 2012-04-14 2012-04-15 2012-04-17 2012-04-18 2012-04-19 \n         1          1          2          1          2          3          5 \n2012-04-20 2012-04-21 2012-04-22 2012-04-25 2012-04-29 2012-05-01 2012-05-03 \n         1          2          2          1          2          1          1 \n2012-05-06 2012-05-08 2012-05-10 2012-05-11 2012-05-13 2012-05-14 2012-05-23 \n         1          1          3          1          1          1          1 \n2012-05-30 2012-06-09 2013-04-14 2013-04-15 2013-04-18 2013-04-21 2013-04-24 \n         1          1          1          1          1          1          2 \n2013-04-25 2013-04-29 2013-04-30 2013-05-01 2013-05-02 2013-05-03 2013-05-07 \n         1          1          1          2          2          3          1 \n2013-05-10 2013-05-11 2013-05-12 2013-05-13 2013-05-15 2013-05-17 2013-05-19 \n         1          1          1          1          1          1          1 \n2013-05-27 2013-06-01 2013-06-09 2013-06-30 2013-07-19 2014-04-15 2014-04-17 \n         1          2          1          1          1          2          5 \n2014-04-19 2014-04-21 2014-04-24 2014-04-25 2014-04-26 2014-04-30 2014-05-01 \n         1          1          1          2          1          1          1 \n2014-05-02 2014-05-04 2014-05-08 2014-05-09 2014-05-10 2014-05-11 2014-05-16 \n         1          2          1          2          2          1          1 \n2014-05-22 2014-05-24 2014-05-25 2014-05-31 2015-04-06 2015-04-15 2015-04-17 \n         1          2          1          1          1          2          2 \n2015-04-18 2015-04-19 2015-04-22 2015-04-23 2015-04-27 2015-04-29 2015-04-30 \n         1          3          3          1          1          2          3 \n2015-05-01 2015-05-07 2015-05-08 2015-05-09 2015-05-14 2015-05-17 2015-05-20 \n         3          1          2          1          2          1          1 \n2015-05-30 2015-06-05 2015-07-05 2015-07-07 2015-07-22 2016-04-10 2016-04-11 \n         1          1          1          1          1          2          1 \n2016-04-12 2016-04-13 2016-04-14 2016-04-15 2016-04-18 2016-04-20 2016-04-21 \n         1          1          2          1          2          1          1 \n2016-04-23 2016-04-26 2016-04-30 2016-05-01 2016-05-02 2016-05-03 2016-05-04 \n         1          1          2          1          1          2          1 \n2016-05-06 2016-05-07 2016-05-11 2016-05-12 2016-05-14 2016-05-18 2016-05-25 \n         2          2          2          1          1          2          1 \n2016-05-31 2016-06-12 2016-06-16 2016-06-18 2016-07-15 2017-04-13 2017-04-14 \n         1          1          1          2          1          2          1 \n2017-04-15 2017-04-16 2017-04-17 2017-04-18 2017-04-19 2017-04-20 2017-04-21 \n         2          1          2          2          1          1          1 \n2017-04-22 2017-04-24 2017-04-26 2017-04-29 2017-05-04 2017-05-06 2017-05-07 \n         1          1          1          1          2          3          2 \n2017-05-10 2017-05-11 2017-05-12 2017-05-19 2017-05-25 2017-06-03 2017-07-02 \n         3          2          1          1          2          1          1 \n2017-07-04 2018-03-25 2018-03-30 2018-04-13 2018-04-18 2018-04-19 2018-04-20 \n         1          1          1          2          1          2          3 \n2018-04-21 2018-04-25 2018-04-26 2018-04-27 2018-04-28 2018-04-29 2018-05-04 \n         2          2          1          1          4          2          1 \n2018-05-05 2018-05-10 2018-05-11 2018-05-13 2018-05-16 2018-05-20 2018-05-21 \n         1          2          1          1          1          1          1 \n2019-04-06 2019-04-12 2019-04-14 2019-04-17 2019-04-18 2019-04-19 2019-04-20 \n         1          3          1          1          1          3          2 \n2019-04-22 2019-04-24 2019-04-26 2019-04-27 2019-05-01 2019-05-02 2019-05-03 \n         1          1          1          4          1          1          2 \n2019-05-06 2019-05-08 2019-05-09 2019-05-10 2019-05-11 2019-05-12 2020-04-06 \n         2          1          2          1          3          1          1 \n2020-04-10 2020-04-11 2020-04-17 2020-04-18 2020-04-20 2020-04-21 2020-04-23 \n         1          1          2          1          2          1          1 \n2020-04-24 2020-04-25 2020-04-26 2020-04-29 2020-04-30 2020-05-01 2020-05-02 \n         2          2          2          2          2          1          1 \n2020-05-06 2020-05-08 2020-05-09 2020-05-10 2020-05-14 2020-05-17 2020-06-24 \n         2          3          3          1          1          1          1 \n2021-04-10 2021-04-12 2021-04-13 2021-04-17 2021-04-18 2021-04-19 2021-04-21 \n         1          1          1          1          1          2          4 \n2021-04-22 2021-04-23 2021-04-24 2021-04-25 2021-04-27 2021-04-28 2021-04-29 \n         3          1          2          1          1          2          2 \n2021-05-01 2021-05-06 2021-05-11 2021-05-13 2021-05-16 2021-05-21 2021-05-26 \n         1          2          1          2          1          1          1 \n2021-05-27 2021-06-04 2021-06-16 2022-04-10 2022-04-13 2022-04-15 2022-04-17 \n         1          1          1          1          1          1          2 \n2022-04-18 2022-04-21 2022-04-22 2022-04-23 2022-04-24 2022-04-26 2022-04-28 \n         2          2          2          1          1          2          2 \n2022-04-30 2022-05-05 2022-05-06 2022-05-08 2022-05-11 2022-05-14 2022-05-15 \n         3          1          2          2          1          1          1 \n2022-05-17 2022-05-19 2022-05-25 2022-05-29 2023-04-15 2023-04-18 2023-04-20 \n         2          2          1          1          1          1          2 \n2023-04-22 2023-04-23 2023-04-24 2023-04-26 2023-04-27 2023-04-28 2023-04-29 \n         2          4          1          1          1          2          1 \n2023-04-30 2023-05-01 2023-05-03 2023-05-04 2023-05-06 2023-05-07 2023-05-10 \n         2          1          1          1          1          2          1 \n2023-05-11 2023-05-17 2023-05-19 2023-05-24 2023-05-25 2023-05-27 2023-05-28 \n         2          1          1          1          1          1          2 \n2023-07-23 2023-08-04 2028-04-19 \n         1          1          1 \n\n$last_observed\n\n           2000-07-21 2000-08-05 2000-08-12 2000-08-13 2000-08-14 2000-08-17 \n       149          1          2          1          2          1          1 \n2000-08-18 2000-08-19 2000-08-20 2000-08-24 2000-08-26 2000-08-30 2000-08-31 \n         1          1          3          1          1          1          1 \n2000-09-01 2000-09-05 2000-09-06 2000-09-07 2000-09-15 2000-09-24 2004-06-14 \n         1          1          1          1          1          1          1 \n2004-07-01 2004-07-18 2004-07-21 2004-07-22 2004-07-23 2004-08-02 2004-08-06 \n         2          1          1          1          1          1          1 \n2004-08-09 2004-08-10 2004-08-13 2004-08-16 2004-08-19 2004-08-22 2004-08-23 \n         1          1          1          1          1          1          1 \n2004-08-24 2004-09-03 2004-09-09 2004-09-10 2005-06-10 2005-06-17 2005-06-24 \n         1          1          1          1          1          1          1 \n2005-06-29 2005-07-07 2005-07-23 2005-07-26 2005-07-28 2005-07-29 2005-07-31 \n         1          1          1          1          1          1          1 \n2005-08-03 2005-08-05 2005-08-13 2005-08-15 2005-08-17 2005-08-18 2005-08-24 \n         1          1          1          1          1          1          1 \n2005-08-26 2005-08-27 2005-08-29 2005-09-08 2005-09-12 2005-09-15 2006-06-18 \n         2          1          1          2          1          1          1 \n2006-06-27 2006-07-13 2006-07-23 2006-07-29 2006-08-05 2006-08-07 2006-08-09 \n         1          1          1          1          1          2          1 \n2006-08-11 2006-08-16 2006-08-17 2006-08-18 2006-08-31 2006-09-02 2006-09-05 \n         1          2          1          1          1          1          1 \n2006-09-10 2006-09-11 2006-09-13 2006-09-17 2006-09-18 2007-06-24 2007-07-18 \n         1          1          1          1          1          1          1 \n2007-08-01 2007-08-06 2007-08-08 2007-08-10 2007-08-11 2007-08-15 2007-08-17 \n         1          1          1          1          1          2          1 \n2007-08-19 2007-08-20 2007-08-22 2007-08-24 2007-08-25 2007-09-02 2007-09-06 \n         3          3          1          2          3          1          1 \n2007-09-08 2007-09-09 2007-09-12 2007-09-15 2008-06-09 2008-06-10 2008-06-14 \n         1          1          1          1          1          1          1 \n2008-06-27 2008-07-18 2008-07-31 2008-08-05 2008-08-07 2008-08-10 2008-08-13 \n         1          2          1          1          1          1          1 \n2008-08-15 2008-08-17 2008-08-19 2008-08-21 2008-08-24 2008-08-26 2008-08-28 \n         1          3          1          1          1          1          1 \n2008-08-29 2008-08-31 2008-09-01 2008-09-04 2008-09-19 2008-09-20 2009-06-10 \n         3          2          1          1          1          1          1 \n2009-07-13 2009-07-17 2009-07-18 2009-07-24 2009-07-26 2009-07-30 2009-08-01 \n         1          2          1          1          1          1          1 \n2009-08-05 2009-08-06 2009-08-07 2009-08-10 2009-08-11 2009-08-12 2009-08-13 \n         1          1          1          1          1          1          2 \n2009-08-14 2009-08-15 2009-08-19 2009-08-20 2009-08-21 2009-08-22 2009-08-24 \n         1          1          1          1          1          1          1 \n2009-08-25 2009-08-27 2009-09-05 2009-09-26 2009-09-27 2010-07-01 2010-07-17 \n         1          1          1          1          1          2          1 \n2010-07-21 2010-07-22 2010-07-27 2010-07-29 2010-07-30 2010-08-01 2010-08-04 \n         1          1          1          3          2          1          1 \n2010-08-05 2010-08-07 2010-08-09 2010-08-11 2010-08-12 2010-08-13 2010-08-14 \n         1          1          1          2          4          1          1 \n2010-08-15 2010-08-17 2010-08-18 2010-08-21 2010-08-23 2010-08-26 2010-09-01 \n         1          1          1          1          1          1          1 \n2010-09-03 2011-06-25 2011-07-06 2011-07-19 2011-07-21 2011-07-26 2011-07-27 \n         1          1          1          1          1          1          1 \n2011-07-29 2011-07-31 2011-08-01 2011-08-02 2011-08-03 2011-08-04 2011-08-05 \n         3          1          1          1          1          1          1 \n2011-08-06 2011-08-10 2011-08-11 2011-08-13 2011-08-15 2011-08-17 2011-08-18 \n         2          1          1          1          1          1          1 \n2011-08-20 2011-08-22 2011-08-23 2011-08-24 2011-08-26 2011-08-27 2012-06-13 \n         1          1          1          1          1          3          1 \n2012-06-16 2012-06-19 2012-06-22 2012-07-01 2012-07-10 2012-07-12 2012-07-13 \n         1          1          1          1          1          1          2 \n2012-07-17 2012-07-19 2012-07-22 2012-07-24 2012-07-25 2012-07-27 2012-08-01 \n         1          1          1          1          1          1          1 \n2012-08-05 2012-08-06 2012-08-08 2012-08-09 2012-08-10 2012-08-11 2012-08-12 \n         1          1          1          1          2          1          1 \n2012-08-16 2012-08-25 2012-08-26 2012-08-31 2012-09-01 2012-09-15 2013-05-09 \n         1          1          2          1          1          2          1 \n2013-06-07 2013-06-09 2013-06-10 2013-06-23 2013-06-26 2013-06-28 2013-07-01 \n         1          1          1          1          1          1          1 \n2013-07-10 2013-07-11 2013-07-21 2013-07-26 2013-07-28 2013-08-01 2013-08-02 \n         1          1          1          1          1          1          1 \n2013-08-03 2013-08-08 2013-08-11 2013-08-12 2013-08-16 2013-08-17 2013-08-21 \n         1          1          2          1          1          1          3 \n2013-08-26 2013-08-30 2013-09-02 2014-04-21 2014-05-03 2014-06-13 2014-06-29 \n         2          1          1          1          1          1          1 \n2014-07-15 2014-07-16 2014-07-24 2014-07-25 2014-07-26 2014-07-27 2014-08-02 \n         1          3          1          1          1          1          1 \n2014-08-03 2014-08-06 2014-08-07 2014-08-09 2014-08-10 2014-08-13 2014-08-14 \n         2          2          1          1          1          1          2 \n2014-08-15 2014-08-16 2014-08-24 2014-08-30 2014-09-06 2014-09-11 2014-09-16 \n         1          1          1          1          1          1          1 \n2015-05-12 2015-06-19 2015-06-22 2015-07-05 2015-07-09 2015-07-16 2015-07-17 \n         1          1          1          1          1          2          1 \n2015-07-23 2015-07-24 2015-07-27 2015-07-28 2015-07-29 2015-07-30 2015-07-31 \n         1          2          1          1          3          1          1 \n2015-08-03 2015-08-04 2015-08-06 2015-08-07 2015-08-09 2015-08-14 2015-08-15 \n         1          1          1          1          1          1          1 \n2015-08-16 2015-08-19 2015-08-20 2015-08-21 2015-08-23 2015-08-30 2015-09-02 \n         1          1          2          1          1          1          1 \n2015-09-03 2015-09-06 2016-06-02 2016-07-07 2016-07-10 2016-07-13 2016-07-14 \n         1          1          1          1          1          2          2 \n2016-07-15 2016-07-17 2016-07-20 2016-07-27 2016-07-28 2016-07-30 2016-07-31 \n         3          1          2          1          2          1          1 \n2016-08-02 2016-08-03 2016-08-04 2016-08-06 2016-08-11 2016-08-12 2016-08-14 \n         1          2          1          3          1          1          1 \n2016-08-15 2016-08-18 2016-08-24 2016-08-25 2016-08-26 2016-08-28 2016-09-02 \n         1          3          2          1          1          1          1 \n2016-09-03 2017-05-17 2017-05-21 2017-06-07 2017-06-24 2017-07-12 2017-07-17 \n         1          1          1          1          1          2          1 \n2017-07-21 2017-07-22 2017-07-23 2017-07-24 2017-07-28 2017-07-29 2017-07-30 \n         1          1          1          1          1          1          1 \n2017-07-31 2017-08-03 2017-08-04 2017-08-05 2017-08-10 2017-08-12 2017-08-13 \n         1          2          1          1          2          1          3 \n2017-08-18 2017-08-19 2017-08-21 2017-08-23 2017-08-24 2017-08-26 2017-08-30 \n         1          1          1          1          1          2          1 \n2017-09-11 2018-06-21 2018-06-23 2018-06-25 2018-07-05 2018-07-13 2018-07-16 \n         2          1          1          1          1          1          1 \n2018-07-21 2018-07-22 2018-07-23 2018-07-25 2018-07-26 2018-07-28 2018-07-29 \n         1          1          1          2          1          1          1 \n2018-07-30 2018-08-01 2018-08-02 2018-08-04 2018-08-08 2018-08-12 2018-08-15 \n         1          1          2          2          1          1          1 \n2018-08-23 2018-08-26 2018-08-29 2018-09-03 2018-09-06 2018-09-10 2019-05-20 \n         1          1          3          1          1          1          1 \n2019-06-12 2019-07-03 2019-07-18 2019-07-21 2019-07-24 2019-07-25 2019-07-26 \n         2          1          1          1          1          1          1 \n2019-07-30 2019-07-31 2019-08-01 2019-08-08 2019-08-09 2019-08-10 2019-08-12 \n         1          1          1          1          2          1          1 \n2019-08-14 2019-08-17 2019-08-18 2019-08-19 2019-08-21 2019-08-24 2019-08-26 \n         2          1          1          2          2          2          1 \n2019-08-27 2019-08-31 2019-09-06 2019-09-08 2019-09-16 2020-06-21 2020-07-02 \n         1          1          1          1          1          1          1 \n2020-07-15 2020-07-23 2020-07-26 2020-08-03 2020-08-05 2020-08-09 2020-08-11 \n         1          3          1          1          1          1          2 \n2020-08-12 2020-08-13 2020-08-14 2020-08-16 2020-08-19 2020-08-20 2020-08-22 \n         2          3          1          1          2          1          1 \n2020-08-26 2020-08-27 2020-08-28 2020-08-30 2020-09-04 2020-09-09 2020-09-12 \n         2          2          1          1          1          1          2 \n2020-09-17 2021-05-12 2021-06-03 2021-06-04 2021-06-06 2021-06-08 2021-07-04 \n         1          1          1          1          1          1          1 \n2021-07-11 2021-07-14 2021-07-24 2021-07-29 2021-08-01 2021-08-02 2021-08-03 \n         1          1          1          1          1          1          1 \n2021-08-04 2021-08-05 2021-08-11 2021-08-12 2021-08-13 2021-08-15 2021-08-18 \n         1          1          2          1          2          1          2 \n2021-08-19 2021-08-20 2021-08-21 2021-08-22 2021-08-26 2021-08-29 2021-09-01 \n         1          2          1          1          1          1          1 \n2021-09-10 2021-09-18 2021-09-23 2022-05-15 2022-05-27 2022-06-15 2022-06-29 \n         1          1          2          1          1          1          1 \n2022-07-01 2022-07-09 2022-07-18 2022-07-19 2022-07-21 2022-07-22 2022-07-25 \n         1          1          1          1          1          1          1 \n2022-07-26 2022-07-27 2022-07-31 2022-08-01 2022-08-02 2022-08-05 2022-08-06 \n         1          1          2          1          1          1          2 \n2022-08-09 2022-08-10 2022-08-11 2022-08-12 2022-08-17 2022-08-18 2022-08-19 \n         1          1          1          1          1          1          1 \n2022-08-24 2022-08-25 2022-08-28 2022-09-01 2022-09-02 2022-09-13 2023-05-28 \n         1          1          2          1          1          1          1 \n2023-06-14 2023-07-15 2023-07-26 2023-07-28 2023-07-29 2023-07-30 2023-08-02 \n         1          1          2          1          1          1          1 \n2023-08-03 2023-08-04 2023-08-09 2023-08-16 2023-08-17 2023-08-19 2023-08-20 \n         1          2          2          2          1          4          1 \n2023-08-24 2023-08-25 2023-08-26 2023-08-27 2023-08-28 2023-08-31 2023-09-02 \n         1          1          1          1          1          2          2 \n2023-09-09 2023-09-11 2023-09-22 \n         2          1          2 \n\n$first_nest\n\n           2000-05-05 2000-05-09 2000-05-10 2000-05-11 2000-05-13 2000-05-16 \n       189          1          2          3          1          3          1 \n2000-05-18 2000-05-19 2000-05-26 2000-05-28 2000-05-29 2000-05-31 2000-06-01 \n         2          1          1          2          1          1          1 \n2000-06-06 2000-06-08 2000-06-17 2004-05-05 2004-05-08 2004-05-09 2004-05-11 \n         1          1          1          1          1          1          1 \n2004-05-13 2004-05-14 2004-05-15 2004-05-16 2004-05-19 2004-05-20 2004-05-21 \n         2          1          1          2          2          1          1 \n2004-05-22 2004-05-26 2004-05-27 2004-05-28 2004-06-03 2004-06-06 2004-06-14 \n         1          1          1          1          1          1          1 \n2004-06-17 2005-05-04 2005-05-06 2005-05-07 2005-05-08 2005-05-11 2005-05-12 \n         1          1          3          1          1          1          3 \n2005-05-13 2005-05-14 2005-05-17 2005-05-18 2005-05-19 2005-05-20 2005-05-21 \n         1          2          1          1          1          1          1 \n2005-05-26 2005-05-28 2005-06-03 2005-06-10 2005-06-15 2005-06-16 2006-05-10 \n         2          1          1          1          1          1          1 \n2006-05-12 2006-05-14 2006-05-15 2006-05-17 2006-05-18 2006-05-20 2006-05-22 \n         3          1          1          2          1          3          3 \n2006-05-23 2006-05-25 2006-05-27 2006-06-01 2006-06-09 2006-06-10 2006-06-21 \n         1          1          2          1          1          1          1 \n2007-05-12 2007-05-14 2007-05-16 2007-05-17 2007-05-18 2007-05-19 2007-05-22 \n         1          1          3          4          1          2          1 \n2007-05-23 2007-05-25 2007-05-26 2007-05-31 2007-06-02 2007-06-04 2007-06-05 \n         1          1          2          1          1          1          1 \n2007-06-06 2007-06-08 2007-06-17 2007-06-21 2007-06-27 2008-05-06 2008-05-07 \n         1          2          1          1          1          1          1 \n2008-05-09 2008-05-10 2008-05-12 2008-05-15 2008-05-16 2008-05-17 2008-05-18 \n         1          1          2          2          3          2          3 \n2008-05-21 2008-05-23 2008-05-26 2008-05-28 2008-05-31 2008-06-05 2008-06-11 \n         2          1          1          1          1          3          1 \n2008-06-19 2009-05-03 2009-05-04 2009-05-06 2009-05-07 2009-05-09 2009-05-10 \n         1          1          1          1          1          2          1 \n2009-05-12 2009-05-13 2009-05-14 2009-05-18 2009-05-20 2009-05-21 2009-05-24 \n         2          2          4          1          2          1          2 \n2009-06-03 2009-06-06 2009-06-08 2009-06-14 2009-07-29 2010-05-01 2010-05-05 \n         1          2          1          1          1          1          2 \n2010-05-06 2010-05-07 2010-05-08 2010-05-09 2010-05-13 2010-05-14 2010-05-16 \n         3          1          1          1          3          4          2 \n2010-05-21 2010-05-22 2010-05-25 2010-05-27 2010-05-28 2010-06-04 2010-06-05 \n         1          2          1          2          1          2          1 \n2010-06-06 2010-06-09 2010-06-12 2010-06-17 2010-06-18 2011-04-30 2011-05-02 \n         1          1          1          1          1          1          1 \n2011-05-04 2011-05-06 2011-05-08 2011-05-09 2011-05-12 2011-05-14 2011-05-15 \n         1          2          1          2          2          2          3 \n2011-05-17 2011-05-18 2011-05-20 2011-05-21 2011-05-28 2011-05-29 2011-06-02 \n         1          2          1          1          2          3          1 \n2011-06-07 2011-06-08 2011-06-11 2012-04-30 2012-05-02 2012-05-04 2012-05-07 \n         1          1          1          1          1          3          1 \n2012-05-08 2012-05-09 2012-05-10 2012-05-11 2012-05-12 2012-05-13 2012-05-14 \n         1          1          4          4          1          1          2 \n2012-05-15 2012-05-16 2012-05-20 2012-05-24 2012-05-26 2012-05-29 2012-05-30 \n         1          1          2          1          1          1          1 \n2012-06-01 2012-06-11 2013-05-02 2013-05-03 2013-05-06 2013-05-09 2013-05-10 \n         1          1          1          2          1          1          2 \n2013-05-11 2013-05-12 2013-05-13 2013-05-14 2013-05-15 2013-05-16 2013-05-17 \n         2          1          1          2          1          3          1 \n2013-05-26 2013-06-01 2013-06-02 2013-06-06 2013-06-07 2013-06-29 2013-08-15 \n         3          2          1          1          2          1          1 \n2014-04-29 2014-05-01 2014-05-03 2014-05-08 2014-05-09 2014-05-10 2014-05-11 \n         1          1          1          3          4          2          1 \n2014-05-12 2014-05-14 2014-05-16 2014-05-17 2014-05-21 2014-05-22 2014-05-24 \n         2          2          2          1          1          2          2 \n2014-05-28 2014-05-29 2014-05-31 2014-06-01 2014-07-05 2015-04-27 2015-05-03 \n         1          2          1          1          1          1          1 \n2015-05-06 2015-05-07 2015-05-08 2015-05-09 2015-05-11 2015-05-12 2015-05-14 \n         3          2          1          3          4          1          2 \n2015-05-15 2015-05-16 2015-05-19 2015-05-20 2015-05-21 2015-05-24 2015-05-28 \n         2          1          1          2          1          1          1 \n2015-05-30 2015-06-05 2015-06-13 2015-07-11 2016-04-27 2016-04-29 2016-05-01 \n         1          1          1          1          1          1          1 \n2016-05-04 2016-05-05 2016-05-06 2016-05-08 2016-05-11 2016-05-12 2016-05-13 \n         1          2          1          1          2          3          2 \n2016-05-14 2016-05-16 2016-05-18 2016-05-19 2016-05-22 2016-05-25 2016-05-26 \n         2          1          1          1          1          3          1 \n2016-05-28 2016-05-29 2016-06-02 2016-06-04 2016-06-16 2016-06-18 2017-04-28 \n         1          1          1          1          1          2          1 \n2017-04-30 2017-05-03 2017-05-04 2017-05-06 2017-05-07 2017-05-08 2017-05-10 \n         2          1          1          1          2          1          2 \n2017-05-11 2017-05-12 2017-05-13 2017-05-19 2017-05-21 2017-05-24 2017-05-26 \n         2          3          1          3          1          1          1 \n2017-05-28 2017-05-31 2017-06-02 2017-06-03 2017-06-04 2017-06-14 2018-05-03 \n         1          1          2          1          1          1          1 \n2018-05-04 2018-05-06 2018-05-10 2018-05-11 2018-05-12 2018-05-14 2018-05-16 \n         1          2          2          2          2          2          3 \n2018-05-17 2018-05-18 2018-05-19 2018-05-20 2018-05-23 2018-05-29 2018-05-30 \n         2          1          1          2          1          1          2 \n2018-05-31 2018-06-01 2018-06-02 2018-06-15 2019-05-03 2019-05-04 2019-05-05 \n         3          1          1          1          1          1          1 \n2019-05-09 2019-05-10 2019-05-11 2019-05-14 2019-05-16 2019-05-17 2019-05-22 \n         4          3          5          1          1          1          1 \n2019-05-23 2019-05-24 2019-05-25 2019-06-01 2019-06-02 2019-06-05 2019-06-06 \n         1          1          2          1          1          1          2 \n2019-06-12 2019-07-06 2020-05-07 2020-05-10 2020-05-11 2020-05-13 2020-05-14 \n         1          1          1          1          1          2          2 \n2020-05-15 2020-05-16 2020-05-17 2020-05-19 2020-05-20 2020-05-21 2020-05-22 \n         3          1          1          1          1          2          3 \n2020-05-23 2020-05-24 2020-05-28 2020-05-29 2020-05-30 2020-06-03 2020-06-11 \n         1          1          1          2          2          1          1 \n2020-06-12 2020-06-27 2020-07-03 2021-05-05 2021-05-06 2021-05-08 2021-05-09 \n         1          1          1          2          1          1          2 \n2021-05-10 2021-05-12 2021-05-13 2021-05-14 2021-05-17 2021-05-19 2021-05-20 \n         1          2          1          3          1          4          2 \n2021-05-21 2021-05-25 2021-05-27 2021-05-28 2021-05-30 2021-06-02 2021-06-04 \n         1          1          1          1          1          2          2 \n2021-06-17 2022-05-06 2022-05-07 2022-05-08 2022-05-09 2022-05-11 2022-05-14 \n         1          1          1          3          1          1          1 \n2022-05-15 2022-05-16 2022-05-17 2022-05-18 2022-05-19 2022-05-20 2022-05-21 \n         1          1          1          1          2          2          3 \n2022-05-25 2022-05-26 2022-05-27 2022-05-29 2022-06-03 2022-06-08 2022-06-11 \n         1          1          1          2          2          1          1 \n2022-06-25 2022-06-27 2022-07-01 2023-05-07 2023-05-10 2023-05-11 2023-05-12 \n         1          1          1          2          1          1          2 \n2023-05-13 2023-05-14 2023-05-16 2023-05-19 2023-05-21 2023-05-24 2023-05-26 \n         1          3          2          1          1          2          1 \n2023-05-28 2023-05-30 2023-06-01 2023-06-02 2023-06-03 2023-06-07 2023-06-09 \n         1          1          2          2          1          2          1 \n2023-06-10 2023-06-17 2023-07-23 \n         1          1          1 \n\n$first_chick\n\n           2000-05-28 2000-05-31 2000-06-01 2000-06-02 2000-06-03 2000-06-04 \n       262          1          1          1          2          3          1 \n2000-06-06 2000-06-07 2000-06-08 2000-06-09 2000-06-18 2000-06-20 2000-06-22 \n         1          1          1          1          1          2          1 \n2000-06-24 2000-06-26 2000-06-28 2000-07-22 2004-05-31 2004-06-04 2004-06-05 \n         1          1          1          1          2          2          1 \n2004-06-06 2004-06-09 2004-06-11 2004-06-14 2004-06-16 2004-06-18 2004-06-20 \n         1          1          2          1          1          1          1 \n2004-06-21 2004-06-22 2004-06-27 2004-07-04 2004-07-18 2005-05-27 2005-05-28 \n         1          2          1          1          1          1          1 \n2005-06-01 2005-06-02 2005-06-03 2005-06-05 2005-06-06 2005-06-09 2005-06-10 \n         2          3          1          1          1          1          4 \n2005-06-11 2005-06-12 2005-06-15 2005-06-26 2005-07-01 2005-07-21 2006-06-02 \n         1          1          1          2          1          1          1 \n2006-06-03 2006-06-05 2006-06-07 2006-06-09 2006-06-10 2006-06-11 2006-06-13 \n         1          1          1          1          1          1          1 \n2006-06-14 2006-06-16 2006-06-17 2006-06-20 2006-06-24 2006-06-30 2006-07-03 \n         2          2          2          1          2          1          1 \n2006-07-14 2007-06-06 2007-06-07 2007-06-09 2007-06-10 2007-06-11 2007-06-12 \n         1          2          2          1          3          1          2 \n2007-06-13 2007-06-14 2007-06-15 2007-06-20 2007-06-27 2007-06-28 2007-06-29 \n         1          2          3          3          1          1          1 \n2007-07-02 2007-07-15 2007-07-19 2008-05-30 2008-06-02 2008-06-04 2008-06-05 \n         1          1          1          1          1          2          4 \n2008-06-07 2008-06-08 2008-06-09 2008-06-12 2008-06-17 2008-06-18 2008-06-25 \n         1          2          1          2          1          1          1 \n2008-06-26 2008-06-27 2008-06-29 2008-07-06 2008-07-10 2009-05-27 2009-05-28 \n         2          1          1          1          1          1          2 \n2009-05-29 2009-05-30 2009-05-31 2009-06-03 2009-06-04 2009-06-05 2009-06-06 \n         1          1          2          1          4          1          3 \n2009-06-10 2009-06-11 2009-06-17 2009-06-20 2009-06-24 2009-06-25 2009-06-26 \n         1          1          1          1          1          1          1 \n2009-06-29 2009-07-15 2010-05-25 2010-05-26 2010-05-27 2010-05-30 2010-06-01 \n         1          1          1          2          3          3          1 \n2010-06-03 2010-06-04 2010-06-09 2010-06-10 2010-06-11 2010-06-16 2010-06-17 \n         3          1          1          2          1          2          1 \n2010-06-18 2010-06-25 2010-06-30 2010-07-01 2010-07-02 2010-07-07 2010-07-09 \n         1          1          2          1          1          1          1 \n2011-05-25 2011-05-26 2011-05-27 2011-05-29 2011-05-31 2011-06-02 2011-06-03 \n         1          1          1          1          1          2          1 \n2011-06-04 2011-06-05 2011-06-06 2011-06-08 2011-06-09 2011-06-10 2011-06-11 \n         1          1          1          2          1          1          1 \n2011-06-12 2011-06-14 2011-06-16 2011-06-17 2011-06-18 2011-06-30 2011-07-01 \n         1          1          1          1          1          1          1 \n2011-07-10 2011-07-13 2011-07-21 2012-05-20 2012-05-23 2012-05-24 2012-05-26 \n         1          1          1          1          1          1          1 \n2012-05-27 2012-05-28 2012-05-31 2012-06-01 2012-06-02 2012-06-04 2012-06-06 \n         1          2          1          2          1          1          3 \n2012-06-08 2012-06-10 2012-06-15 2012-06-20 2012-06-23 2012-06-24 2012-07-01 \n         1          1          2          1          3          1          1 \n2013-05-11 2013-05-26 2013-05-27 2013-05-29 2013-05-31 2013-06-01 2013-06-03 \n         1          3          1          1          1          1          1 \n2013-06-06 2013-06-07 2013-06-08 2013-06-09 2013-06-12 2013-06-13 2013-06-19 \n         2          3          1          2          1          1          1 \n2013-06-21 2013-06-22 2013-06-23 2013-06-26 2013-06-29 2014-05-22 2014-05-24 \n         1          1          1          1          1          1          1 \n2014-05-25 2014-05-29 2014-05-31 2014-06-01 2014-06-02 2014-06-03 2014-06-05 \n         1          2          2          2          1          1          3 \n2014-06-06 2014-06-09 2014-06-11 2014-06-13 2014-06-14 2014-06-15 2014-06-19 \n         2          1          1          1          2          1          1 \n2014-06-20 2014-06-21 2014-06-29 2014-07-02 2014-07-26 2014-08-01 2015-05-22 \n         1          1          1          1          1          1          1 \n2015-05-25 2015-05-26 2015-05-28 2015-05-29 2015-05-30 2015-05-31 2015-06-04 \n         1          1          2          1          1          2          6 \n2015-06-05 2015-06-06 2015-06-08 2015-06-10 2015-06-11 2015-06-12 2015-06-19 \n         1          1          1          1          1          1          1 \n2015-06-26 2015-06-27 2015-08-02 2016-05-22 2016-05-25 2016-05-26 2016-05-27 \n         1          1          1          1          1          2          1 \n2016-05-28 2016-05-29 2016-06-02 2016-06-04 2016-06-05 2016-06-06 2016-06-08 \n         2          3          1          1          1          1          5 \n2016-06-09 2016-06-10 2016-06-12 2016-06-16 2016-06-17 2016-06-18 2016-07-13 \n         1          1          2          2          1          1          1 \n2016-07-14 2016-07-15 2016-07-16 2017-05-22 2017-05-25 2017-05-26 2017-05-28 \n         1          1          1          1          3          1          3 \n2017-05-30 2017-06-01 2017-06-02 2017-06-03 2017-06-08 2017-06-11 2017-06-12 \n         1          3          3          1          1          1          1 \n2017-06-14 2017-06-16 2017-06-17 2017-06-21 2017-06-22 2017-06-24 2018-05-27 \n         2          1          1          2          1          1          1 \n2018-05-30 2018-05-31 2018-06-02 2018-06-03 2018-06-04 2018-06-05 2018-06-07 \n         1          3          1          1          1          1          4 \n2018-06-08 2018-06-10 2018-06-13 2018-06-14 2018-06-18 2018-06-20 2018-06-23 \n         2          2          1          1          1          1          1 \n2018-06-25 2018-06-28 2018-07-13 2019-05-30 2019-05-31 2019-06-02 2019-06-03 \n         1          1          1          2          2          1          2 \n2019-06-04 2019-06-05 2019-06-06 2019-06-07 2019-06-09 2019-06-16 2019-06-18 \n         1          1          1          1          1          3          1 \n2019-06-20 2019-06-23 2019-06-26 2019-06-27 2019-06-30 2019-07-02 2019-07-03 \n         1          1          2          2          1          1          2 \n2019-07-04 2020-05-31 2020-06-01 2020-06-03 2020-06-04 2020-06-05 2020-06-07 \n         1          1          1          1          3          1          1 \n2020-06-12 2020-06-13 2020-06-14 2020-06-19 2020-06-20 2020-06-21 2020-06-23 \n         2          1          2          2          1          2          1 \n2020-06-27 2020-07-02 2020-07-03 2020-07-05 2020-07-09 2020-07-16 2020-07-20 \n         1          1          2          2          1          1          1 \n2020-07-30 2021-05-28 2021-05-30 2021-05-31 2021-06-03 2021-06-04 2021-06-05 \n         1          1          1          2          3          1          1 \n2021-06-06 2021-06-07 2021-06-11 2021-06-12 2021-06-14 2021-06-16 2021-06-18 \n         1          1          2          2          1          1          1 \n2021-06-27 2021-06-30 2021-07-01 2021-07-02 2021-07-15 2022-05-27 2022-06-02 \n         2          1          2          1          1          1          5 \n2022-06-03 2022-06-04 2022-06-06 2022-06-08 2022-06-11 2022-06-12 2022-06-13 \n         1          1          1          1          1          2          1 \n2022-06-15 2022-06-16 2022-06-17 2022-06-19 2022-06-20 2022-06-22 2022-06-23 \n         1          1          3          1          1          1          2 \n2022-06-25 2023-05-28 2023-05-31 2023-06-01 2023-06-04 2023-06-05 2023-06-09 \n         1          1          1          1          1          4          1 \n2023-06-10 2023-06-14 2023-06-17 2023-06-18 2023-06-19 2023-06-23 2023-06-25 \n         2          2          1          1          1          1          1 \n2023-06-29 2023-07-05 2023-07-09 2023-07-27 2023-08-02 2023-08-04 3000-06-02 \n         1          1          1          1          1          1          1 \n\n$first_fledge\n\n           2000-06-20 2000-06-21 2000-06-22 2000-06-24 2000-06-25 2000-06-26 \n       387          1          1          2          3          2          2 \n2000-06-30 2000-07-04 2000-07-08 2000-07-13 2000-07-15 2000-07-16 2000-07-17 \n         2          1          1          1          1          1          1 \n2000-07-20 2000-07-24 2000-08-06 2004-06-23 2004-06-25 2004-06-26 2004-06-30 \n         1          1          1          1          1          1          1 \n2004-07-02 2004-07-04 2004-07-10 2004-07-13 2004-07-14 2004-07-17 2004-07-18 \n         1          2          1          1          2          1          1 \n2004-07-25 2005-06-22 2005-06-23 2005-06-24 2005-06-25 2005-06-30 2005-07-01 \n         1          3          1          2          3          1          1 \n2005-07-02 2005-07-07 2005-07-08 2005-07-13 2005-07-18 2005-07-20 2005-07-22 \n         1          1          1          1          1          1          1 \n2005-08-27 2006-06-23 2006-06-25 2006-06-29 2006-06-30 2006-07-01 2006-07-04 \n         1          1          1          1          1          1          2 \n2006-07-07 2006-07-12 2006-07-13 2006-07-15 2006-07-17 2006-07-24 2006-07-28 \n         3          1          1          2          1          1          1 \n2006-08-02 2006-08-11 2007-06-26 2007-06-27 2007-06-28 2007-06-29 2007-06-30 \n         1          1          1          1          2          1          1 \n2007-07-02 2007-07-04 2007-07-05 2007-07-06 2007-07-10 2007-07-11 2007-07-12 \n         2          3          1          1          1          2          2 \n2007-07-13 2007-07-18 2007-07-23 2007-08-08 2008-06-20 2008-06-22 2008-06-25 \n         2          2          1          2          1          1          2 \n2008-06-26 2008-06-27 2008-06-28 2008-06-29 2008-07-02 2008-07-15 2008-07-17 \n         3          1          2          1          1          1          1 \n2008-07-18 2008-07-20 2008-07-24 2008-07-30 2008-07-31 2008-08-17 2009-06-16 \n         1          2          1          1          1          1          1 \n2009-06-20 2009-06-21 2009-06-24 2009-06-25 2009-06-26 2009-06-29 2009-06-30 \n         2          1          3          3          1          1          1 \n2009-07-01 2009-07-03 2009-07-05 2009-07-10 2009-07-15 2009-07-16 2009-07-20 \n         1          1          1          1          2          1          1 \n2009-08-07 2010-06-09 2010-06-16 2010-06-17 2010-06-18 2010-06-20 2010-06-22 \n         1          1          1          2          3          2          1 \n2010-06-24 2010-06-25 2010-06-27 2010-06-30 2010-07-01 2010-07-09 2010-07-14 \n         1          2          1          1          1          2          2 \n2010-07-21 2010-07-23 2010-07-27 2010-07-29 2010-07-30 2010-08-05 2011-06-14 \n         1          1          1          1          1          1          1 \n2011-06-17 2011-06-19 2011-06-22 2011-06-23 2011-06-25 2011-06-27 2011-06-28 \n         1          1          1          4          2          1          1 \n2011-07-01 2011-07-03 2011-07-06 2011-07-09 2011-07-11 2011-07-21 2011-07-22 \n         3          1          1          1          1          1          1 \n2011-07-24 2012-06-15 2012-06-17 2012-06-19 2012-06-21 2012-06-22 2012-06-23 \n         1          1          2          1          1          1          1 \n2012-06-24 2012-06-26 2012-06-27 2012-06-28 2012-06-29 2012-07-01 2012-07-03 \n         1          1          1          1          1          1          1 \n2012-07-07 2012-07-14 2012-07-15 2012-07-19 2012-07-21 2012-08-17 2013-06-20 \n         1          1          1          1          1          1          1 \n2013-06-21 2013-06-22 2013-06-23 2013-06-26 2013-06-27 2013-06-29 2013-06-30 \n         1          2          1          1          2          2          1 \n2013-07-02 2013-07-04 2013-07-05 2013-07-10 2013-07-11 2013-07-17 2013-07-20 \n         1          1          1          2          1          1          1 \n2013-07-31 2013-08-02 2014-06-15 2014-06-16 2014-06-18 2014-06-19 2014-06-21 \n         1          1          1          2          1          3          1 \n2014-06-22 2014-06-23 2014-06-27 2014-06-28 2014-07-03 2014-07-04 2014-07-05 \n         2          1          3          1          1          2          2 \n2014-07-09 2014-07-12 2014-07-16 2014-08-09 2014-08-15 2015-06-13 2015-06-14 \n         1          1          1          1          1          1          3 \n2015-06-17 2015-06-18 2015-06-20 2015-06-22 2015-06-25 2015-06-26 2015-06-27 \n         1          1          1          1          2          3          1 \n2015-06-30 2015-07-02 2015-07-03 2015-07-04 2015-07-17 2015-08-19 2016-06-09 \n         1          1          2          1          1          1          1 \n2016-06-14 2016-06-15 2016-06-17 2016-06-19 2016-06-23 2016-06-24 2016-06-27 \n         1          1          1          3          4          1          1 \n2016-06-29 2016-07-02 2016-07-03 2016-07-06 2016-07-07 2016-07-08 2016-07-09 \n         2          3          3          2          2          2          1 \n2016-08-05 2017-06-11 2017-06-15 2017-06-17 2017-06-18 2017-06-20 2017-06-21 \n         1          2          1          1          1          1          1 \n2017-06-22 2017-06-23 2017-06-24 2017-06-27 2017-06-29 2017-07-02 2017-07-05 \n         3          1          1          2          1          1          1 \n2017-07-06 2017-07-07 2017-07-11 2017-07-12 2017-07-14 2017-07-25 2017-08-05 \n         1          1          1          1          1          1          1 \n2018-06-21 2018-06-22 2018-06-23 2018-06-24 2018-06-26 2018-06-27 2018-06-28 \n         2          1          2          2          1          2          3 \n2018-06-29 2018-07-04 2018-07-05 2018-07-06 2018-07-12 2018-07-14 2018-07-19 \n         1          2          1          1          1          1          1 \n2018-08-03 2019-06-19 2019-06-20 2019-06-21 2019-06-23 2019-06-26 2019-06-27 \n         1          1          1          1          1          1          2 \n2019-06-28 2019-06-29 2019-06-30 2019-07-01 2019-07-03 2019-07-04 2019-07-07 \n         1          1          1          1          1          1          1 \n2019-07-08 2019-07-10 2019-07-12 2019-07-13 2019-07-18 2019-07-19 2019-07-20 \n         1          1          2          1          1          1          1 \n2019-07-21 2019-08-01 2020-06-20 2020-06-24 2020-06-25 2020-07-02 2020-07-03 \n         3          1          1          2          3          1          1 \n2020-07-04 2020-07-08 2020-07-09 2020-07-13 2020-07-14 2020-07-15 2020-07-17 \n         1          1          3          1          1          2          2 \n2020-07-24 2020-07-26 2020-08-06 2020-08-13 2020-08-23 2022-06-25 \n         1          2          1          1          1          1 \n```\n\n\n:::\n:::\n\n\nWe use `lapply` rather than `sapply` for this step because the table for each\ncolumn will have a different length (but try `sapply` and see what happens!).\n\n\n### The Split-Apply Pattern\n\nIn a data set with categorical features, it's often useful to compute something\nfor each category. The `lapply` and `sapply` functions can compute something\nfor each element of a data structure, but categories are not necessarily\nelements.\n\n\n::: {.cell}\n\n:::\n\n\nFor example, the least terns data set has 6 different categories in\nthe `region_3` column. If we want all of the rows for one region, one way to\nget them is by indexing:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsouthern = terns[terns$region_3 == \"SOUTHERN\", ]\nhead(southern)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   year                             site_name\n8  2000 SANTA CLARA RIVER MCGRATH STATE BEACH\n9  2000                          ORMOND BEACH\n10 2000                       NBVC POINT MUGU\n11 2000                          VENICE BEACH\n12 2000                             LA HARBOR\n13 2000            SEAL BEACH NWR ANAHEIM BAY\n                   site_name_2013_2018  site_name_1988_2001    site_abbr\n8                    Santa Clara River NA_2013_2018 POLYGON   S_CLAR_MCG\n9                         Ormond Beach NA_2013_2018 POLYGON       ORMOND\n10                     NBVC Point Mugu NA_2013_2018 POLYGON      PT_MUGU\n11                        Venice Beach NA_2013_2018 POLYGON      VEN_BCH\n12                          Port of LA NA_2013_2018 POLYGON      LA_HARB\n13 Seal Beach National Wildlife Refuge NA_2013_2018 POLYGON SEAL_BCH_NWR\n   region_3 region_4   event bp_min bp_max fl_min fl_max total_nests\n8  SOUTHERN  VENTURA LA_NINA     21     21      9      9          22\n9  SOUTHERN  VENTURA LA_NINA     73     73     60     65          73\n10 SOUTHERN  VENTURA LA_NINA    166    167     64     64         252\n11 SOUTHERN SOUTHERN LA_NINA    274    294    150    200         308\n12 SOUTHERN SOUTHERN LA_NINA    437    437    570    570         565\n13 SOUTHERN SOUTHERN LA_NINA    107    107    180    180         107\n   nonpred_eggs nonpred_chicks nonpred_fl nonpred_ad pred_control pred_eggs\n8             4              3         NA         NA                     NA\n9             2              0          0          0                     NA\n10           NA             NA         NA         NA                     NA\n11           26             NA         NA         NA                     32\n12           77             NA         NA         NA                     24\n13           10              3         NA         NA                     NA\n   pred_chicks pred_fl pred_ad pred_pefa pred_coy_fox pred_meso pred_owlspp\n8           NA      NA      NA                                             \n9           NA      NA      NA         N            N         Y           N\n10          NA      NA      NA                                             \n11          20      20       3         Y            N         Y           N\n12          NA      15      NA         Y            N         N           N\n13          NA      NA      NA                                             \n   pred_corvid pred_other_raptor pred_other_avian pred_misc total_pefa\n8                                                                   NA\n9            N                 Y                N         N         NA\n10                                                                  NA\n11           Y                 N                N         N          2\n12           N                 Y                Y         N         17\n13                                                                  NA\n   total_coy_fox total_meso total_owlspp total_corvid total_other_raptor\n8             NA         NA           NA           NA                 NA\n9             NA         NA           NA           NA                 NA\n10            NA         NA           NA           NA                 NA\n11             0         42            0           31                  0\n12             0          0            0            0                  4\n13            NA         NA           NA           NA                 NA\n   total_other_avian total_misc first_observed last_observed first_nest\n8                 NA         NA     2000-06-06    2000-09-05 2000-06-06\n9                 NA         NA                              2000-06-08\n10                NA         NA     2000-05-21    2000-08-12 2000-06-01\n11                 0          0     2000-04-19    2000-08-20 2000-05-29\n12                24          0     2000-04-28    2000-08-20 2000-05-10\n13                NA         NA                                        \n   first_chick first_fledge\n8   2000-06-28   2000-07-24\n9   2000-06-26   2000-07-17\n10  2000-06-24   2000-07-16\n11                         \n12  3000-06-02   2000-06-22\n13                         \n```\n\n\n:::\n:::\n\n\nTo get all 6 regions separately, we'd have to do this 6\ntimes. If we want to compute something for each region, say the median of the\n`total_nests` column, we also have to repeat that computation 6\ntimes. Here's what it would look like for just the `SOUTHERN` region:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedian(southern$total_nests, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 64\n```\n\n\n:::\n:::\n\n\nIf the categories were elements, we could avoid writing code to index each\ncategory, and just use the `sapply` (or `lapply`) function to apply the\n`median` function to each.\n\nThe `split` function splits a vector or data frame into groups based on a\nvector of categories. The first argument to `split` is the data, and the\nsecond argument is a congruent vector of categories.\n\nWe can use `split` to elegantly compute medians of `total_nests` broken down by\ncountry. First, we split the data by region Since we only want to compute on\nthe `total_nests` column, we only split that column:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nby_region = split(terns$total_nests, terns$region_3)\nclass(by_region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"list\"\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(by_region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"ARIZONA\"    \"CENTRAL\"    \"KINGS\"      \"S.F._BAY\"   \"SACRAMENTO\"\n[6] \"SOUTHERN\"  \n```\n\n\n:::\n:::\n\n\nThe result from `split` is a list with one element for each category. The\nindividual elements contain pieces of the original `total_nests` column:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(by_region$SOUTHERN)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  22  73 252 308 565 107\n```\n\n\n:::\n:::\n\n\nSince the categories are elements in the split data, now we can use `sapply`\nthe same way we did in previous examples:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(by_region, median, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ARIZONA    CENTRAL      KINGS   S.F._BAY SACRAMENTO   SOUTHERN \n         3         17          1         35          1         64 \n```\n\n\n:::\n:::\n\n\nThis two-step process is an R idiom called the **split-apply pattern**. First\nyou use `split` to convert categories into list elements, then you use an apply\nfunction to compute something on each category. Any time you want to compute\nresults by category, you should think of this pattern.\n\nThe split-apply pattern is so useful that R provides the `tapply` function as a\nshortcut. The `tapply` function is equivalent to calling `split` and then\n`sapply`. Like `split`, the first argument is the data and the second argument\nis a congruent vector of categories. The third argument is a function to apply,\nlike the function argument in `sapply`.\n\nWe can use `tapply` to compute the `total_nests` medians by `region_3` for the\nleast terns data set:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntapply(terns$total_nests, terns$region_3, median, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   ARIZONA    CENTRAL      KINGS   S.F._BAY SACRAMENTO   SOUTHERN \n         3         17          1         35          1         64 \n```\n\n\n:::\n:::\n\n\nNotice that the result is identical to the one we computed before.\n\nThe \"t\" in `tapply` stands for \"table\", because the `tapply` function is a\ngeneralization of the `table` function. If you use `length` as the third\nargument to `tapply`, you get the same results as you would from using the\n`table` function on the category vector.\n\nThe `aggregate` function is closely related to `tapply`. It computes the same\nresults, but organizes them into a data frame with one row for each category.\nIn some cases, this format is more convenient. The arguments are the same,\nexcept that the second argument must be a list or data frame rather than a\nvector.\n\nAs an example, here's the result of using `aggregate` to compute the\n`total_nests` medians:\n\n\n::: {.cell}\n\n```{.r .cell-code}\naggregate(terns$total_nests, list(terns$region_3), mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Group.1          x\n1    ARIZONA  3.0000000\n2    CENTRAL 21.5584416\n3      KINGS  0.8666667\n4   S.F._BAY         NA\n5 SACRAMENTO  0.9000000\n6   SOUTHERN         NA\n```\n\n\n:::\n:::\n\n\nThe `lapply`, `sapply`, and `tapply` functions are the three most important\nfunctions in the family of apply functions, but there are many more. You can\nlearn more about all of R's apply functions by reading [this StackOverflow\npost][apply].\n\n[apply]: https://stackoverflow.com/a/7141669\n\n\n## Exercises\n\n### Exercise\n\n1. Compute the total number of fledglings (with `fl_min`) for each year and\n   region combination.\n2. Another way to present the data in @sec-example-bar-plot is with a\n   line plot. Use the data from part 1 to make this plot with points for each\n   total and lines connecting the totals. Hint: find the appropriate geometries\n   in the ggplot2 documentation.\n\n### Exercise\n\n1. Compute the number of sites with no egg mortalities due to predation.\n2. Of those, how many had at least one fledgling?\n\n### Exercise\n\n1. Compute the range (minimum and maximum) of `year` for each site.\n2. How many many sites have observations over the entire range of the data set\n   (2000 and 2004-2023)? Hint: use the `unique` and `length` functions to find\n   the number of unique years for each site.\n",
    "supporting": [
      "03_exploring-data_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}