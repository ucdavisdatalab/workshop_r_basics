<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Exploring Data – R Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/04_organizing_code.html" rel="next">
<link href="../chapters/02_data-structures.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03_exploring-data.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploring Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="https://datalab.ucdavis.edu/" class="sidebar-logo-link">
      <img src="../images/datalab-logo-full-color-rgb-1.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">R Basics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01_getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02_data-structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Structures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03_exploring-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploring Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04_organizing_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Organizing Code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Appendix</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/97_where-to-learn-more.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Where to Learn More</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/98_acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/99_assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assessment</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#indexing-data-frames" id="toc-indexing-data-frames" class="nav-link active" data-scroll-target="#indexing-data-frames"><span class="header-section-number">3.1</span> Indexing Data Frames</a>
  <ul class="collapse">
  <li><a href="#indexing-lists" id="toc-indexing-lists" class="nav-link" data-scroll-target="#indexing-lists"><span class="header-section-number">3.1.1</span> Indexing Lists</a></li>
  <li><a href="#two-dimensional-indexing" id="toc-two-dimensional-indexing" class="nav-link" data-scroll-target="#two-dimensional-indexing"><span class="header-section-number">3.1.2</span> Two-dimensional Indexing</a></li>
  </ul></li>
  <li><a href="#sec-packages" id="toc-sec-packages" class="nav-link" data-scroll-target="#sec-packages"><span class="header-section-number">3.2</span> Packages</a></li>
  <li><a href="#sec-data-visualization" id="toc-sec-data-visualization" class="nav-link" data-scroll-target="#sec-data-visualization"><span class="header-section-number">3.3</span> Data Visualization</a>
  <ul class="collapse">
  <li><a href="#layer-1-data" id="toc-layer-1-data" class="nav-link" data-scroll-target="#layer-1-data"><span class="header-section-number">3.3.1</span> Layer 1: Data</a></li>
  <li><a href="#layer-2-geometry" id="toc-layer-2-geometry" class="nav-link" data-scroll-target="#layer-2-geometry"><span class="header-section-number">3.3.2</span> Layer 2: Geometry</a></li>
  <li><a href="#layer-3-aesthetics" id="toc-layer-3-aesthetics" class="nav-link" data-scroll-target="#layer-3-aesthetics"><span class="header-section-number">3.3.3</span> Layer 3: Aesthetics</a></li>
  <li><a href="#layer-4-scales" id="toc-layer-4-scales" class="nav-link" data-scroll-target="#layer-4-scales"><span class="header-section-number">3.3.4</span> Layer 4: Scales</a></li>
  <li><a href="#saving-plots" id="toc-saving-plots" class="nav-link" data-scroll-target="#saving-plots"><span class="header-section-number">3.3.5</span> Saving Plots</a></li>
  <li><a href="#example-bar-plot" id="toc-example-bar-plot" class="nav-link" data-scroll-target="#example-bar-plot"><span class="header-section-number">3.3.6</span> Example: Bar Plot</a></li>
  <li><a href="#visualization-design" id="toc-visualization-design" class="nav-link" data-scroll-target="#visualization-design"><span class="header-section-number">3.3.7</span> Visualization Design</a></li>
  </ul></li>
  <li><a href="#apply-functions" id="toc-apply-functions" class="nav-link" data-scroll-target="#apply-functions"><span class="header-section-number">3.4</span> Apply Functions</a>
  <ul class="collapse">
  <li><a href="#the-sapply-function" id="toc-the-sapply-function" class="nav-link" data-scroll-target="#the-sapply-function"><span class="header-section-number">3.4.1</span> The <code>sapply</code> Function</a></li>
  <li><a href="#the-split-apply-pattern" id="toc-the-split-apply-pattern" class="nav-link" data-scroll-target="#the-split-apply-pattern"><span class="header-section-number">3.4.2</span> The Split-Apply Pattern</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">3.5</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="header-section-number">3.5.1</span> Exercise</a></li>
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1"><span class="header-section-number">3.5.2</span> Exercise</a></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2"><span class="header-section-number">3.5.3</span> Exercise</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploring Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Goals
</div>
</div>
<div class="callout-body-container callout-body">
<p>After completing this chapter, learners should be able to:</p>
<ul>
<li>Describe when to use <code>[</code> versus <code>[[</code></li>
<li>Index data frames to get specific rows, columns, or subsets</li>
<li>Install and load packages</li>
<li>Describe the grammar of graphics</li>
<li>Make a plot</li>
<li>Save a plot to an image file</li>
<li>Call a function repeatedly with <code>sapply</code> or <code>lapply</code></li>
<li>Split data into groups and apply a function to each</li>
</ul>
</div>
</div>
<p>Now that you have a solid foundation in the basic functions and data structures of R, you can move on to its most popular application: data analysis. In this chapter, you’ll learn how to efficiently explore and summarize data with visualizations and statistics. Along the way, you’ll also learn how to use apply functions, which are essential to fluency in R.</p>
<section id="indexing-data-frames" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="indexing-data-frames"><span class="header-section-number">3.1</span> Indexing Data Frames</h2>
<p>This section explains how to get and set data in a data frame, expanding on the indexing techniques you learned in <a href="02_data-structures.html#sec-indexing" class="quarto-xref"><span>Section 2.4</span></a>. Under the hood, every data frame is a list, so first you’ll learn about indexing lists.</p>
<section id="indexing-lists" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="indexing-lists"><span class="header-section-number">3.1.1</span> Indexing Lists</h3>
<p>Lists are a <strong>container</strong> for other types of R objects. When you select an element from a list, you can either keep the container (the list) or discard it. The indexing operator <code>[</code> almost always keeps containers.</p>
<p>As an example, let’s get some elements from a small list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">list</span>(<span class="at">first =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">second =</span> sin, <span class="at">third =</span> <span class="fu">c</span>(<span class="st">"hi"</span>, <span class="st">"hello"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$first
[1] 1 2 3

$third
[1] "hi"    "hello"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
<p>The result is still a list. Even if we get just one element, the result of indexing a list with <code>[</code> is a list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
<p>Sometimes this will be exactly what we want. But what if we want to get the first element of <code>x</code> so that we can use it in a vectorized function? Or in a function that only accepts numeric arguments? We need to somehow get the element and discard the container.</p>
<p>The solution to this problem is the <strong>extraction operator</strong> <code>[[</code>, which is also called the double square bracket operator. The extraction operator is the primary way to get and set elements of lists and other containers.</p>
<p>Unlike the indexing operator <code>[</code>, the extraction operator always discards the container:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<p>The tradeoff is that the extraction operator can only get or set one element at a time. Note that the element can be a vector, as above. Because it can only get or set one element at a time, the extraction operator can only index by position or name. Blank and logical indexes are not allowed.</p>
<p>The final difference between the index operator <code>[</code> and the extraction operator <code>[[</code> has to do with how they handle invalid indexes. The index operator <code>[</code> returns <code>NA</code> for invalid vector elements, and <code>NULL</code> for invalid list elements:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)[<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$&lt;NA&gt;
NULL</code></pre>
</div>
</div>
<p>On the other hand, the extraction operator <code>[[</code> raises an error for invalid elements:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x[[<span class="dv">10</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in x[[10]]: subscript out of bounds</code></pre>
</div>
</div>
<p>The indexing operator <code>[</code> and the extraction operator <code>[[</code> both work with any data structure that has elements. However, you’ll generally use the indexing operator <code>[</code> to index vectors, and the extraction operator <code>[[</code> to index containers (such as lists).</p>
</section>
<section id="two-dimensional-indexing" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="two-dimensional-indexing"><span class="header-section-number">3.1.2</span> Two-dimensional Indexing</h3>
<p>For two-dimensional objects, like matrices and data frames, you can pass the indexing operator <code>[</code> or the extraction operator <code>[[</code> a separate index for each dimension. The rows come first:</p>
<pre><code>DATA[ROWS, COLUMNS]</code></pre>
<p>For instance, let’s get the first 3 rows and all columns of the banknotes data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>banknotes[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  currency_code   country    currency_name                       name gender
1           ARS Argentina Argentinian Peso                  Eva Perón      F
2           ARS Argentina Argentinian Peso       Julio Argentino Roca      M
3           ARS Argentina Argentinian Peso Domingo Faustino Sarmiento      M
  bill_count    profession known_for_being_first current_bill_value
1          1      Activist                    No                100
2          1 Head of Gov't                    No                100
3          1 Head of Gov't                    No                 50
  prop_total_bills first_appearance_year death_year comments hover_text
1               NA                  2012       1952                    
2               NA                  1988       1914                    
3               NA                  1999       1888                    
  has_portrait            id scaled_bill_value
1         true     ARS_Evita         1.0000000
2         true ARS_Argentino         1.0000000
3         true   ARS_Domingo         0.4444444</code></pre>
</div>
</div>
<p>As we saw in <a href="02_data-structures.html#sec-all-elements" class="quarto-xref"><span>Section 2.4.1</span></a>, leaving an index blank means all elements.</p>
<p>As another example, let’s get the 3rd and 5th row, and the 2nd and 4th column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>banknotes[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    country                       name
3 Argentina Domingo Faustino Sarmiento
5 Argentina            Manuel Belgrano</code></pre>
</div>
</div>
<p>Mixing several different ways of indexing is allowed. So for example, we can get the same above, but use column names instead of positions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>banknotes[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="st">"currency_name"</span>, <span class="st">"name"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     currency_name                       name
3 Argentinian Peso Domingo Faustino Sarmiento
5 Argentinian Peso            Manuel Belgrano</code></pre>
</div>
</div>
<p>For data frames, it’s especially common to index the rows by condition and the columns by name. For instance, let’s get the <code>name</code> and <code>profession</code> columns for all women in the banknotes data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> banknotes[banknotes<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"F"</span>, <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"profession"</span>)]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 name profession
1           Eva Perón   Activist
7        Mary Gilmore     Writer
10        Edith Cowan Politician
11       Nellie Melba   Musician
13        Mary Reibey      Other
14 Queen Elizabeth II    Monarch</code></pre>
</div>
</div>
<p>Also see <a href="05_appendix.html#sec-the-drop-parameter" class="quarto-xref"><span>Section 5.2</span></a> for a case where the <code>[</code> operator behaves in a surprising way.</p>
</section>
</section>
<section id="sec-packages" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-packages"><span class="header-section-number">3.2</span> Packages</h2>
<p>A <strong>package</strong> is a collection of functions for use in R. Packages usually include documentation, and can also contain examples, vignettes, and data sets. Most packages are developed by members of the R community, so quality varies. There are also a few packages that are built into R but provide extra features. We’ll use a package in <a href="#sec-data-visualization" class="quarto-xref"><span>Section 3.3</span></a>, so we’re learning about them now.</p>
<p>The <a href="https://cran.r-project.org/">Comprehensive R Archive Network</a>, or CRAN, is the main place people publish packages. As of writing, there were 18,619 packages posted to CRAN. This number has been steadily increasing as R has grown in popularity.</p>
<p>Packages span a wide variety of topics and disciplines. There are packages related to statistics, social sciences, geography, genetics, physics, biology, pharmacology, economics, agriculture, and more. The best way to find packages is to search online, but the CRAN website also provides <a href="https://cran.r-project.org/web/views/">“task views”</a> if you want to browse popular packages related to a specific discipline.</p>
<p>The <code>install.packages</code> function installs one or more packages from CRAN. Its first argument is the packages to install, as a character vector.</p>
<p>When you run <code>install.packages</code>, R will ask you to choose which <strong>mirror</strong> to download the package from. A mirror is a web server that has the same set of files as some other server. Mirrors are used to make downloads faster and to provide redundancy so that if a server stops working, files are still available somewhere else. CRAN has dozens of mirrors; you should choose one that’s geographically nearby, since that usually produces the best download speeds. If you aren’t sure which mirror to choose, you can use the 0-Cloud mirror, which attempts to automatically choose a mirror near you.</p>
<p>As an example, here’s the code to install the remotes package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you run the code above, you’ll be asked to select a mirror, and then see output that looks something like this:</p>
<pre><code>--- Please select a CRAN mirror for use in this session ---
trying URL 'https://cloud.r-project.org/src/contrib/remotes_2.3.0.tar.gz'
Content type 'application/x-gzip' length 148405 bytes (144 KB)
==================================================
downloaded 144 KB

* installing *source* package ‘remotes’ ...
** package ‘remotes’ successfully unpacked and MD5 sums checked
** using staged installation
** R
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (remotes)

The downloaded source packages are in
        ‘/tmp/Rtmp8t6iGa/downloaded_packages’</code></pre>
<p>R goes through a variety of steps to install a package, even installing other packages that the package depends on. You can tell that a package installation succeeded by the final line <code>DONE</code>. When a package installation fails, R prints an error message explaining the problem instead.</p>
<p>Once a package is installed, it stays on your computer until you remove it or remove R. This means you only need to install each package once. However, most packages are periodically updated. You can reinstall a package using <code>install.packages</code> the same way as above to get the latest version.</p>
<p>Alternatively, you can update all of the R packages you have installed at once by calling the <code>update.packages</code> function. Beware that this may take a long time if you have a lot of packages installed.</p>
<p>The function to remove packages is <code>remove.packages</code>. Like <code>install.packages</code>, this function’s first argument is the packages to remove, as a character vector.</p>
<p>If you want to see which packages are installed, you can use the <code>installed.packages</code> function. It does not require any arguments. It returns a matrix with one row for each package and columns that contain a variety of information. Here’s an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">=</span> <span class="fu">installed.packages</span>()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Just print the version numbers for 10 packages.</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>packages[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="st">"Version"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     abind        ape    askpass assertthat  backports  base64enc         BH 
   "1.4-5"      "5.8"    "1.2.0"    "0.2.1"    "1.4.1"    "0.1-3" "1.84.0-0" 
       bit      bit64     bitops 
   "4.0.5"    "4.0.5"    "1.0-7" </code></pre>
</div>
</div>
<p>You’ll see a different set of packages, since you have a different computer.</p>
<p>Before you can use the functions (or other resources) in an installed package, you must load the package with the <code>library</code> function. R doesn’t load packages automatically because each package you load uses memory and may conflict with other packages. Thus you should only load the packages you need for whatever it is that you want to do. When you restart R, the loaded packages are cleared and you must again load any packages you want to use.</p>
<p>Let’s load the remotes package we installed earlier:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"remotes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>library</code> function works with or without quotes around the package name, so you may also see people write things like <code>library(remotes)</code>. We recommend using quotes to make it unambiguous that you are not referring to a variable.</p>
<p>A handful of packages print out a message when loaded, but the vast majority do not. Thus you can assume the call to <code>library</code> was successful if nothing is printed. If something goes wrong while loading a package, R will print out an error message explaining the problem.</p>
<p>Finally, not all R packages are published to CRAN. <a href="https://github.com/">GitHub</a> is another popular place to publish R packages, especially ones that are experimental or still in development. Unlike CRAN, GitHub is a general-purpose website for publishing code written in any programming language, so it contains much more than just R packages and is not specifically R-focused.</p>
<p>The remotes package that we just installed and loaded provides functions to install packages from GitHub. It is generally better to install packages from CRAN when they are available there, since the versions on CRAN tend to be more stable and intended for a wide audience. However, if you want to install a package from GitHub, you can learn more about the remotes package by reading its <a href="https://remotes.r-lib.org/">online documentation</a>.</p>
</section>
<section id="sec-data-visualization" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="sec-data-visualization"><span class="header-section-number">3.3</span> Data Visualization</h2>
<p>There are three popular systems for creating visualizations in R:</p>
<ol type="1">
<li>The base R functions (primarily the <code>plot</code> function)</li>
<li>The lattice package</li>
<li>The ggplot2 package</li>
</ol>
<p>These three systems are not interoperable! Consequently, it’s best to choose one to use exclusively. Compared to base R, both lattice and ggplot2 are better at handling grouped data and generally require less code to create a nice-looking visualization.</p>
<p>The ggplot2 package is so popular that there are now knockoff packages for other data-science-oriented programming languages like Python and Julia. The package is also part of the <a href="https://www.tidyverse.org/">Tidyverse</a>, a popular collection of R packages designed to work well together. Because of these advantages, we’ll use ggplot2 for visualizations in this and all future lessons.</p>
<p>ggplot2 has detailed <a href="https://ggplot2.tidyverse.org/">documentation</a> and also a <a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf">cheatsheet</a>.</p>
<p>The “gg” in ggplot2 stands for <strong>grammar of graphics</strong>. The idea of a grammar of graphics is that visualizations can be built up in layers. In ggplot2, the three layers every plot must have are:</p>
<ul>
<li>Data</li>
<li>Geometry</li>
<li>Aesthetics</li>
</ul>
<p>There are also several optional layers. Here are a few:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Layer</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>scales</td>
<td>Title, label, and axis value settings</td>
</tr>
<tr class="even">
<td>facets</td>
<td>Side-by-side plots</td>
</tr>
<tr class="odd">
<td>guides</td>
<td>Axis and legend position settings</td>
</tr>
<tr class="even">
<td>annotations</td>
<td>Shapes that are not mapped to data</td>
</tr>
<tr class="odd">
<td>coordinates</td>
<td>Coordinate systems (Cartesian, logarithmic, polar)</td>
</tr>
</tbody>
</table>
<p>As an example, let’s plot the banknotes data. First, we need to load ggplot2. As always, if this is your first time using the package, you’ll have to install it. Then you can load the package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplot2")</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What kind of plot should we make? It depends on what we want to know about the data set. Suppose we want to understand the relationship between a banknote’s value and how long ago the person on the banknote died, as well as whether this is affected by gender. One way to show this is to make a scatter plot.</p>
<!-- FIXME: Move this type correction to chapter 2 -->
<p>Before plotting, we need to make sure that the <code>death_year</code> column is numeric:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>is_blank <span class="ot">=</span> banknotes<span class="sc">$</span>death_year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"-"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>banknotes<span class="sc">$</span>death_year[is_blank] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>banknotes<span class="sc">$</span>death_year <span class="ot">=</span> <span class="fu">as.numeric</span>(banknotes<span class="sc">$</span>death_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’re ready to make the plot.</p>
<section id="layer-1-data" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="layer-1-data"><span class="header-section-number">3.3.1</span> Layer 1: Data</h3>
<p>The data layer determines the data set used to make the plot. ggplot and most other Tidyverse packages are designed for working with <strong>tidy</strong> data frames. Tidy means:</p>
<ol type="1">
<li>Each observation has its own row.</li>
<li>Each feature has its own column.</li>
<li>Each value has its own cell.</li>
</ol>
<p>Tidy data sets are convenient in general. A later lesson will cover how to make an untidy data set tidy. Until then, we’ll take it for granted that the data sets we work with are tidy.</p>
<p>To set up the data layer, call the <code>ggplot</code> function on a data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This returns a blank plot. We still need to add a few more layers.</p>
</section>
<section id="layer-2-geometry" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="layer-2-geometry"><span class="header-section-number">3.3.2</span> Layer 2: Geometry</h3>
<p>The <strong>geom</strong>etry layer determines the shape or appearance of the visual elements of the plot. In other words, the geometry layer determines what kind of plot to make: one with points, lines, boxes, or something else.</p>
<p>There are many different geometries available in ggplot2. The package provides a function for each geometry, always prefixed with <code>geom_</code>.</p>
<p>To add a geometry layer to the plot, choose the <code>geom_</code> function you want and add it to the plot with the <code>+</code> operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `geom_point()`:
! Problem while setting up geom.
ℹ Error occurred in the 1st layer.
Caused by error in `compute_geom_1()`:
! `geom_point()` requires the following missing aesthetics: x and y.</code></pre>
</div>
</div>
<p>This returns an error message that we’re missing aesthetics <code>x</code> and <code>y</code>. We’ll learn more about aesthetics in the next section, but this error message is especially helpful: it tells us exactly what we’re missing. When you use a geometry you’re unfamiliar with, it can be helpful to run the code for just the data and geometry layer like this, to see exactly which aesthetics need to be set.</p>
<p>As we’ll see later, it’s possible to add multiple geometries to a plot.</p>
</section>
<section id="layer-3-aesthetics" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="layer-3-aesthetics"><span class="header-section-number">3.3.3</span> Layer 3: Aesthetics</h3>
<p>The <strong>aes</strong>thetic layer determines the relationship between the data and the geometry. Use the aesthetic layer to map features in the data to <strong>aesthetics</strong> (visual elements) of the geometry.</p>
<p>The <code>aes</code> function creates an aesthetic layer. The syntax is:</p>
<pre><code>aes(AESTHETIC = FEATURE, ...)</code></pre>
<p>The names of the aesthetics depend on the geometry, but some common ones are <code>x</code>, <code>y</code>, <code>color</code>, <code>fill</code>, <code>shape</code>, and <code>size</code>. There is more information about and examples of aesthetic names in the documentation.</p>
<p>For example, we want to put <code>death_year</code> on the x-axis and <code>scaled_bill_value</code> on the y-axis. It’s best to use <code>scaled_bill_value</code> here rather than <code>current_bill_value</code> because the different countries use different scales of currency. For example, 1 United States Dollar is worth approximately 100 Japanese Yen. So the aesthetic layer should be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the <code>aes</code> function, column names are never quoted. In older versions of ggplot2, you must pass the aesthetic layer as the second argument of the <code>ggplot</code> function rather than using <code>+</code> to add it to the plot. This syntax is still widely used:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes, <span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="per-geometry-aesthetics" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="per-geometry-aesthetics">Per-geometry Aesthetics</h4>
<p>When you add the aesthetic layer or pass it to the <code>ggplot</code> function, it applies to the entire plot. You can also set an aesthetic layer individually for each geometry, by passing the layer as the first argument in the <code>geom_</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is really only useful when you have multiple geometries. As an example, let’s color-code the points by gender:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value, <span class="at">color =</span> gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s also add labels to each point. To do this, we need to add another geometry:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value, <span class="at">color =</span> gender, <span class="at">label =</span> name) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_text()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Where we put the aesthetics matters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value, <span class="at">label =</span> name) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">color =</span> gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_text()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="constant-aesthetics" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="constant-aesthetics">Constant Aesthetics</h4>
<p>If you want to set an aesthetic to a constant value, rather than one that’s data dependent, do so in the geometry layer rather than the aesthetic layer. For instance, suppose use point shape rather than color to indicate gender, and we want to make all of the points blue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value, <span class="at">shape =</span> gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If you set an aesthetic to a constant value inside of the aesthetic layer, the results you get might not be what you expect:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value, <span class="at">shape =</span> gender, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="layer-4-scales" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="layer-4-scales"><span class="header-section-number">3.3.4</span> Layer 4: Scales</h3>
<p>The scales layer controls the title, axis labels, and axis scales of the plot. Most of the functions in the scales layer are prefixed with <code>scale_</code>, but not all of them.</p>
<p>The <code>labs</code> function is especially important, because it’s used to set the title and axis labels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value, <span class="at">shape =</span> gender) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Death Year"</span>, <span class="at">y =</span> <span class="st">"Scaled Bill Value"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Does death year affect bill value?"</span>, <span class="at">shape =</span> <span class="st">"Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="saving-plots" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="saving-plots"><span class="header-section-number">3.3.5</span> Saving Plots</h3>
<p>In ggplot2, use the <code>ggsave</code> function to save the most recent plot you created:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"banknote_scatter.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The file format is selected automatically based on the extension. Common formats are PNG and PDF.</p>
<section id="the-plot-device" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-plot-device">The Plot Device</h4>
<p>You can also save a plot with one of R’s “plot device” functions. The steps are:</p>
<ol type="1">
<li>Call a plot device function: <code>png</code>, <code>jpeg</code>, <code>pdf</code>, <code>bmp</code>, <code>tiff</code>, or <code>svg</code>.</li>
<li>Run your code to make the plot.</li>
<li>Call <code>dev.off</code> to indicate that you’re done plotting.</li>
</ol>
<p>This strategy works with any of R’s graphics systems (not just ggplot2).</p>
<p>Here’s an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run these lines in the console, not the notebook!</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="st">"banknote_scatter.jpeg"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> death_year, <span class="at">y =</span> scaled_bill_value, <span class="at">shape =</span> gender) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Death Year"</span>, <span class="at">y =</span> <span class="st">"Scaled Bill Value"</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Does death year affect bill value?"</span>, <span class="at">shape =</span> <span class="st">"Gender"</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="example-bar-plot" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="example-bar-plot"><span class="header-section-number">3.3.6</span> Example: Bar Plot</h3>
<p>Now suppose you want to plot the number of banknotes with people from each profession in the banknotes data set. A bar plot is in an appropriate way to represent this visually.</p>
<p>The geometry for a bar plot is <code>geom_bar</code>. Since bar plots are mainly used to display frequencies, the <code>geom_bar</code> function automatically computes frequencies when given mapped to a categorical feature.</p>
<p>We can also use a fill color to further breakdown the bars by gender. Here’s the code to make the bar plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(banknotes) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> profession, <span class="at">fill =</span> gender) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_exploring-data_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The setting <code>position = "dodge"</code> instructs <code>geom_bar</code> to put the bars side-by-side rather than stacking them.</p>
<p>In some cases, you may want to make a bar plot with frequencies you’ve already computed. To prevent <code>geom_bar</code> from computing frequencies automatically, set <code>stat = "identity"</code>.</p>
</section>
<section id="visualization-design" class="level3" data-number="3.3.7">
<h3 data-number="3.3.7" class="anchored" data-anchor-id="visualization-design"><span class="header-section-number">3.3.7</span> Visualization Design</h3>
<p>Designing high-quality visualizations goes beyond just mastering which R functions to call. You also need to think carefully about what kind of data you have and what message you want to convey. This section provides a few guidelines.</p>
<p>The first step in data visualization is choosing an appropriate kind of plot. Here are some suggestions (not rules):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Feature 1</th>
<th style="text-align: left;">Feature 2</th>
<th style="text-align: left;">Plot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">categorical</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">bar, dot</td>
</tr>
<tr class="even">
<td style="text-align: left;">categorical</td>
<td style="text-align: left;">categorical</td>
<td style="text-align: left;">bar, dot, mosaic</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numerical</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">box, density, histogram</td>
</tr>
<tr class="even">
<td style="text-align: left;">numerical</td>
<td style="text-align: left;">categorical</td>
<td style="text-align: left;">box, density, ridge</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numerical</td>
<td style="text-align: left;">numerical</td>
<td style="text-align: left;">line, scatter, smooth scatter</td>
</tr>
</tbody>
</table>
<p>If you want to add a:</p>
<ul>
<li>3rd numerical feature, use it to change point/line sizes.</li>
<li>3rd categorical feature, use it to change point/line styles.</li>
<li>4th categorical feature, use side-by-side plots.</li>
</ul>
<p>Once you’ve selected a plot, here are some rules you should almost always follow:</p>
<ul>
<li><p>Always add a title and axis labels. These should be in plain English, not variable names!</p></li>
<li><p>Specify units after the axis label if the axis has units. For instance, “Height (ft)”.</p></li>
<li><p>Don’t forget that many people are colorblind! Also, plots are often printed in black and white. Use point and line styles to distinguish groups; color is optional.</p></li>
<li><p>Add a legend whenever you’ve used more than one point or line style.</p></li>
<li><p>Always write a few sentences explaining what the plot reveals. Don’t describe the plot, because the reader can just look at it. Instead, explain what they can learn from the plot and point out important details that are easily overlooked.</p></li>
<li><p>Sometimes points get plotted on top of each other. This is called <em>overplotting</em>. Plots with a lot of overplotting can be hard to read and can even misrepresent the data by hiding how many points are present. Use a two-dimensional density plot or jitter the points to deal with overplotting.</p></li>
<li><p>For side-by-side plots, use the same axis scales for both plots so that comparing them is not deceptive.</p></li>
</ul>
<p>Visualization design is a deep topic, and whole books have been written about it. One resource where you can learn more is DataLab’s <a href="https://ucdavisdatalab.github.io/workshop_data_viz_principles/">Principles of Data Visualization Workshop Reader</a>.</p>
</section>
</section>
<section id="apply-functions" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="apply-functions"><span class="header-section-number">3.4</span> Apply Functions</h2>
<p><a href="02_data-structures.html#sec-vectorization" class="quarto-xref"><span>Section 2.1.3</span></a> introduced vectorization, a convenient and efficient way to compute multiple results. That section also mentioned that some of R’s functions—the ones that summarize or aggregate data—are not vectorized.</p>
<p>The <code>class</code> function is an example of a function that’s not vectorized. If we call the <code>class</code> function on the banknotes data set, we get just one result for the data set as a whole:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(banknotes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
<p>What if we want to get the class of each column? We can get the class for a single column by selecting the column with <code>$</code>, the dollar sign operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(banknotes<span class="sc">$</span>currency_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>But what if we want the classes for all the columns? We could write a call to <code>class</code> for each column, but that would be tedious. When you’re working with a programming language, you should try to avoid tedium; there’s usually a better, more automated way.</p>
<p><a href="02_data-structures.html#sec-lists" class="quarto-xref"><span>Section 2.2.1</span></a> pointed out that data frames are technically lists, where each column is one element. With that in mind, what we need here is a line of code that calls <code>class</code> on each element of the data frame. The idea is similar to vectorization, but since we have a list and a non-vectorized function, we have to do a bit more than just call <code>class(banknotes)</code>.</p>
<p>The <code>lapply</code> function calls, or <em>applies</em>, a function on each element of a list or vector. The syntax is:</p>
<pre><code>lapply(X, FUN, ...)</code></pre>
<p>The function <code>FUN</code> is called once for each element of <code>X</code>, with the element as the first argument. The <code>...</code> is for additional arguments to <code>FUN</code>, which are held constant across all the elements.</p>
<p>Let’s try this out with the banknotes data and the <code>class</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(banknotes, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$currency_code
[1] "character"

$country
[1] "character"

$currency_name
[1] "character"

$name
[1] "character"

$gender
[1] "character"

$bill_count
[1] "numeric"

$profession
[1] "character"

$known_for_being_first
[1] "character"

$current_bill_value
[1] "integer"

$prop_total_bills
[1] "numeric"

$first_appearance_year
[1] "integer"

$death_year
[1] "numeric"

$comments
[1] "character"

$hover_text
[1] "character"

$has_portrait
[1] "character"

$id
[1] "character"

$scaled_bill_value
[1] "numeric"</code></pre>
</div>
</div>
<p>The result is similar to if the <code>class</code> function was vectorized. In fact, if we use a vector and a vectorized function with <code>lapply</code>, the result is nearly identical to the result from vectorization:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, pi)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sin</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.414710e-01 9.092974e-01 1.224647e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x, sin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.841471

[[2]]
[1] 0.9092974

[[3]]
[1] 1.224647e-16</code></pre>
</div>
</div>
<p>The only difference is that the result from <code>lapply</code> is a list. In fact, the <code>lapply</code> function always returns a list with one element for each element of the input data. The “l” in <code>lapply</code> stands for “list”.</p>
<p>The <code>lapply</code> function is one member of a family of functions called <em>apply functions</em>. All of the apply functions provide ways to apply a function repeatedly to different parts of a data structure. We’ll meet a few more apply functions soon.</p>
<p>When you have a choice between using vectorization or an apply function, you should always choose vectorization. Vectorization is clearer—compare the two lines of code above—and it’s also significantly more efficient. In fact, vectorization is the most efficient way to call a function repeatedly in R.</p>
<p>As we saw with the <code>class</code> function, there are some situations where vectorization is not possible. That’s when you should think about using an apply function.</p>
<section id="the-sapply-function" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="the-sapply-function"><span class="header-section-number">3.4.1</span> The <code>sapply</code> Function</h3>
<p>The related <code>sapply</code> function calls a function on each element of a list or vector, and simplifies the result. That last part is the crucial difference compared to <code>lapply</code>. When results from the calls all have the same type and length, <code>sapply</code> returns a vector or matrix instead of a list. When the results have different types or lengths, the result is the same as for <code>lapply</code>. The “s” in <code>sapply</code> stands for “simplify”.</p>
<p>For instance, if we use <code>sapply</code> to find the classes of the columns in the banknotes data, we get a character vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(banknotes, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        currency_code               country         currency_name 
          "character"           "character"           "character" 
                 name                gender            bill_count 
          "character"           "character"             "numeric" 
           profession known_for_being_first    current_bill_value 
          "character"           "character"             "integer" 
     prop_total_bills first_appearance_year            death_year 
            "numeric"             "integer"             "numeric" 
             comments            hover_text          has_portrait 
          "character"           "character"           "character" 
                   id     scaled_bill_value 
          "character"             "numeric" </code></pre>
</div>
</div>
<p>Likewise, if we use <code>sapply</code> to compute the <code>sin</code> values, we get a numeric vector, the same as from vectorization:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x, sin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.414710e-01 9.092974e-01 1.224647e-16</code></pre>
</div>
</div>
<p>In spite of that, vectorization is still more efficient than <code>sapply</code>, so use vectorization instead when possible.</p>
<p>Apply functions are incredibly useful for summarizing data. For example, suppose we want to compute the frequencies for all of the columns in the banknotes data set that aren’t numeric.</p>
<p>First, we need to identify the columns. One way to do this is with the <code>is.numeric</code> function. Despite the name, this function actually tests whether its argument is a real number, not whether it its argument is a numeric vector. In other words, it also returns true for integer values. We can use <code>sapply</code> to apply this function to all of the columns in the banknotes data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>is_not_number <span class="ot">=</span> <span class="sc">!</span><span class="fu">sapply</span>(banknotes, is.numeric)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>is_not_number</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        currency_code               country         currency_name 
                 TRUE                  TRUE                  TRUE 
                 name                gender            bill_count 
                 TRUE                  TRUE                 FALSE 
           profession known_for_being_first    current_bill_value 
                 TRUE                  TRUE                 FALSE 
     prop_total_bills first_appearance_year            death_year 
                FALSE                 FALSE                 FALSE 
             comments            hover_text          has_portrait 
                 TRUE                  TRUE                  TRUE 
                   id     scaled_bill_value 
                 TRUE                 FALSE </code></pre>
</div>
</div>
<p>Is it worth using R code to identify the non-numeric columns? Since there are only 17 columns in the banknotes data set, maybe not. But if the data set was larger, with say 100 columns, it definitely would be.</p>
<p>In general, it’s a good habit to use R to do things rather than do them manually. You’ll get more practice programming, and your code will be more flexible if you want to adapt it to other data sets.</p>
<p>Now that we know which columns are non-numeric, we can use the <code>table</code> function to compute frequencies. We only want to compute frequencies for those columns, so we need to subset the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(banknotes[, is_not_number], table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$currency_code

ARS AUD BDT BOB CAD CLP COP CRC CVE CZK DOP GBP GEL IDR ILS ISK JMD JPY KGS KRW 
  5   9   9  15   9   5  11   6   5   6  11   8   9  12   4   5   5   3   7   4 
MWK MXN NGN NZD PEN PGK PHP RMB RSD SEK STD TND TRY UAH USD UYU VES​ VES ZAR 
  7  11   9   5   7   1   9   6   9   6   8   4  12  10   7   7   2   6   5 

$country

            Argentina             Australia            Bangladesh 
                    5                     9                     9 
              Bolivia                Canada            Cape Verde 
                   15                     9                     5 
                Chile                 China              Colombia 
                    5                     6                    11 
           Costa Rica        Czech Republic    Dominican Republic 
                    6                     6                    11 
              England               Georgia               Iceland 
                    8                     9                     5 
            Indonesia                Israel               Jamaica 
                   12                     4                     5 
                Japan            Kyrgyzstan                Malawi 
                    3                     7                     7 
               Mexico           New Zealand               Nigeria 
                   11                     5                     9 
     Papua New Guinea                  Peru           Philippines 
                    1                     7                     9 
São Tomé and Príncipe                Serbia          South Africa 
                    8                     9                     5 
          South Korea                Sweden               Tunisia 
                    4                     6                     4 
               Turkey               Ukraine         United States 
                   12                    10                     7 
              Uruguay             Venezuela 
                    7                     8 

$currency_name

  Argentinian Peso  Australian Dollar          Boliviano    Canadian Dollar 
                 5                  9                 15                  9 
      Chilean Peso     Colombian Peso              Colón       Czech koruna 
                 5                 11                  6                  6 
             dobra             Escudo             hryvna    Jamaican dollar 
                 8                  5                 10                  5 
              kina              Króna             Kwacha               lari 
                 1                  5                  7                  9 
              Lira              naira New Zealand dollar    Peso dominicano 
                12                  9                  5                 11 
     Peso mexicano      Peso uruguayo               piso              pound 
                11                  7                  9                  8 
              rand           Renminbi             rupiah      Serbian dinar 
                 5                  6                 12                  9 
            shekel                Sol                Som      Swedish krona 
                 4                  7                  7                  6 
              Taka     Tunisian dinar          US dollar Venezuelan bolivar 
                 9                  4                  7                  8 
               Won                Yen 
                 4                  3 

$name

               Abou el Kacem Chebbi                     Abraham Lincoln 
                                  1                                   1 
           Abraham Valdelomar Pinto                      Agnes Macphail 
                                  1                                   1 
                    Akaki Tsereteli                         Alan Turing 
                                  1                                   1 
                    Alejo Calatayud                  Alexander Hamilton 
                                  1                                   1 
            Alfonso López Michelsen             Alfredo González Flores 
                                  1                                   1 
            Alfredo Vásquez Acevedo              Alhaji Aliyu Mai-Bornu 
                                  1                                   1 
 Alhaji Sir Abubarkar Tafawa Balewa             Alhaji Sir Ahmadu Bello 
                                  1                                   1 
                     Alykul Osmonov                        Andrés Bello 
                                  1                                   1 
                     Andrew Jackson               Antonio José de Sucre 
                                  1                                   2 
                    Apiaguaiki Tüpa                       Apirana Ngata 
                                  1                                   1 
            Aristides Maria Pereira                  Arturo Prat Chacón 
                                  1                                   1 
                    Astrid Lindgren                        Aydın Sayılı 
                                  1                                   1 
  Bangabandhu Sheikh Mujibur Rahman                      Banjo Paterson 
                                  9                                   1 
                     Bartolina Sisa              Benigno S. Aquino, Jr. 
                                  1                                   1 
                      Benito Juárez                   Benjamin Franklin 
                                  2                                   1 
                     Birgit Nilsson                  Bogdan Khmelnitsky 
                                  1                                   1 
                     Božena Němcová             Braulio Carrillo Colina 
                                  1                                   1 
                        Bruno Racua                Brynjólfur Sveinsson 
                                  1                                   1 
                          Cahit Arf              Carlos Lleras Restrepo 
                                  1                                   1 
                      Carmen Serdán                       Cesária Évora 
                                  1                                   1 
                         Charles IV               Chief Obafemi Awolowo 
                                  1                                   1 
                       Codé Di Dona                   Corazon C. Aquino 
                                  1                                   1 
                   Dag Hammarskiöld            Dámaso Antonio Larrañaga 
                                  1                                   1 
                      David Unaipon                       Debora Arango 
                                  1                                   1 
                       Diego Rivera               Diosdado P. Macapagal 
                                  1                                   1 
               Djuanda Kartawidjaja          Domingo Faustino Sarmiento 
                                  1                                   1 
                      Dorde Vajfert                     Dr. Alvan Ikoku 
                                  1                                   1 
                  Dr. Clement Isong           Dr. Hastings Kamuzu Banda 
                                  1                                   1 
                 Dr. Nnamdi Azikiwe                         Edith Cowan 
                                  1                                   1 
                     Edmund Hillary                      Eduardo Fabini 
                                  1                                   1 
                     Ema Destinnová                   Emilio Prud'Homme 
                                  1                                   1 
                   Eustaquio Méndez                           Eva Perón 
                                  1                                   1 
                        Evert Taube                     Ezequiel Zamora 
                                  1                                   1 
                      Farhat Hached                   Fatma Aliye Topuz 
                                  1                                   1 
               Francisco de Miranda        Francisco de Paula Santander 
                                  1                                   1 
      Francisco del Rosario Sánchez                 Francisco I. Madero 
                                  1                                   1 
            Francisco José Tenreiro                      Frans Kaisiepo 
                                  1                                   1 
                  František Palacký                         Frida Kahlo 
                                  1                                   1 
             Gabriel García Márquez                    Gabriela Mistral 
                                  1                                   1 
           General Murtala Mohammed                       Genoveva Ríos 
                                  1                                   1 
                  George Washington                    Gregorio Luperon 
                                  1                                   1 
                        Greta Garbo                      GSSJ Ratulangi 
                                  1                                   1 
                   Gusti Ngurah Rai                            Hannibal 
                                  1                                   1 
         Henrique Teixeira de Sousa                     Hermila Galindo 
                                  1                                   1 
                     Hideyo Noguchi                  Hryhoriy Skovoroda 
                                  1                                   1 
                Hugh Lawson Shearer                      Ichiyo Higuchi 
                                  1                                   1 
                       Idham Chalid               Ignacio Carrera Pinto 
                                  1                                   1 
                  Ilia Chavchavadze                      Ingmar Bergman 
                                  1                                   1 
      Inkosi ya Makhosi M'mbelwa II         Inkosi Ya Mokhosi Gomani II 
                                  1                                   1 
   Itri (Buhurizade Mustafa Efendi)                         Ivan Franko 
                                  1                                   1 
                        Ivan Mazepa                 Ivane Javakhishvili 
                                  1                                   1 
                      J.M.W. Turner              James Federick Sangala 
                                  1                                   1 
     James Gladstone (Akay-na-muka)                         Jane Austen 
                                  1                                   1 
                Jóhannes S. Kjarval                   John A. Macdonald 
                                  1                                   1 
                 John Amos Comenius                      Jón Sigurdsson 
                                  1                                   1 
                 Jónas Hallgrímsson                       Jorge Barbosa 
                                  1                                   1 
             Jorge Basadre Grohmann                Jorge Eliécer Gaitán 
                                  1                                   1 
                       Jorge Isaacs                    José Abad Santos 
                                  1                                   1 
    José Abelardo Quiñones Gonzales                 José Asunción Silva 
                                  1                                   1 
                   José Félix Ribas                       José Figueres 
                                  1                                   1 
          José Manuel Baca "Cañoto"                  José María Morelos 
                                  1                                   1 
                  José Pedro Varela         José Rufino Reyes y Siancas 
                                  1                                   1 
                 José Santos Vargas                       Josefa Camejo 
                                  1                                   1 
               Josefa Llanes Escoda                        Jovan Cvijic 
                                  1                                   1 
               Juan Manuel de Rosas                   Juan Pablo Duarte 
                                  1                                   1 
        Juan Zorrilla de San Martín            Juana Azurduy de Padilla 
                                  1                                   1 
                Juana de Ibarbourou                Julio Argentino Roca 
                                  1                                   1 
              Julio Garavito Armero                     Jusup Balasagyn 
                                  1                                   1 
  Kaikhosro (Kakutsa) Cholokashvili                       Kate Sheppard 
                                  1                                   1 
                      Kemal Atatürk                          Kemaleddin 
                                  6                                   1 
                      King David IV               King Sejong the Great 
                                  1                                   1 
                    Kurmanjan Datka                          Ladi Kwali 
                                  1                                   1 
                      Leah Goldberg                      Lesya Ukrainka 
                                  1                                   1 
                    Manuel A. Roxas                     Manuel Belgrano 
                                  1                                   1 
                   Manuel L. Quezon            Manuel Rodríguez Erdoyza 
                                  1                                   1 
                         Mao Zedong María Isabel Carvajal (Carmen Lyra) 
                                  6                                   1 
        María Isabel Granda y Larco                María Teresa Mirabal 
                                  1                                   1 
                       Mary Gilmore                         Mary Reibey 
                                  1                                   1 
                 Matías Ramón Mella               Mauro Fernández Acuña 
                                  1                                   1 
              Michael Norman Manley                      Michael Somare 
                                  1                                   1 
                     Miguel Hidalgo                  Milutin Milanković 
                                  1                                   1 
                    Minerva Mirabal                      Mohammad Hatta 
                                  1                                   1 
             Mohammad Husni Thamrin                 Mykhailo Hrusheskyi 
                                  1                                   1 
                   Nadežda Petrović                Nanny of the Maroons 
                                  1                                   1 
                    Nathan Alterman                        Nellie Melba 
                                  1                                   1 
                     Nelson Mandela                      Nezahualcóyotl 
                                  5                                   1 
               Niko Pirosmanashvili                        Nikola Tesla 
                                  1                                   1 
               Oto Iskander Di Nata                 Pablo Zárate Willka 
                                  1                                   1 
                     Patria Mirabal                        Pedro Figari 
                                  1                                   1 
              Pedro Henriquez Ureña                 Pedro Ignacio Muiba 
                                  1                                   1 
                       Pedro Paulet               Petar Petrovic Njegoš 
                                  1                                   1 
             Policarpa Salavarrieta                     Prince Antasari 
                                  1                                   1 
                 Queen Elizabeth II                         Queen Tamar 
                                  7                                   1 
                   Rachel Bluwstein                     Rafael Urdaneta 
                                  1                                   1 
              Ragnheiður Jónsdóttir             Raúl Porras Barrenechea 
                                  1                                   1 
                         Rei Amador             Reverend John Chilembwe 
                                  7                                   2 
                Reverend John Flynn            Ricardo Jiménez Oreamuno 
                                  1                                   1 
           Rose Lomathinda Chibambo                Rutherford of Nelson 
                                  1                                   1 
                       Salomé Ureña                       Samuel Sharpe 
                                  1                                   1 
                 Santa Rosa de Lima                   Sayakbay Karalaev 
                                  1                                   1 
                      Sergio Osmeña                Shaul Tchernichovsky 
                                  1                                   1 
                      Shin Saimdang                     Shota Rustaveli 
                                  1                                   1 
                      Simón Bolívar                     Simón Rodrigues 
                                  2                                   1 
                Sir Donald Sangster          Sir George-Étienne Cartier 
                                  1                                   1 
                    Sir John Monash                   Sir Robert Borden 
                                  1                                   1 
                Sir Wilfrid Laurier                  Slobodan Jovanovic 
                                  1                                   1 
                           Soekarno           Sor Juana Inés de la Cruz 
                                  1                                   1 
        Stevan Stevanovic Mokranjac         Sultan Mahmud Badaruddin II 
                                  1                                   1 
                Suymonkul Chokmorov                    Taras Shevchenko 
                                  1                                   1 
                 Tewhida Ben Sheikh                    Thomas Jefferson 
                                  1                                   1 
                        Tjut Meutia                       Togolok Moldo 
                                  1                                   1 
                Toktogul Satylganov              Tomáš Garrigue Masaryk 
                                  1                                   1 
                       Tomás Katari    Tupac Katari (Julian Apasa Nina) 
                                  1                                   1 
                   Ulysses S. Grant                         Vicente Lim 
                                  1                                   1 
                      Viola Desmond                  Virginia Gutiérrez 
                                  1                                   1 
                Volodymyr the Great                Volodymyr Vernadskyi 
                                  1                                   1 
            Vuk Stefanovic Karadžic         William Lyon Mackenzie King 
                                  1                                   1 
                  Winston Churchill                   Yaroslav the Wise 
                                  1                                   1 
                           Yi Hwang                                Yi I 
                                  1                                   1 
                   Yukichi Fukuzawa                          Yunus Emre 
                                  1                                   1 
                Zakaria Paliashvili 
                                  1 

$gender

  F   M 
 59 220 

$profession

        Activist         Educator          Founder    Head of Gov't 
               4                4               45               43 
        Military          Monarch         Musician            Other 
              13               18               12                5 
       Performer       Politician Religious figure    Revolutionary 
               3               27                3               28 
            STEM    Visual Artist           Writer 
              16               13               45 

$known_for_being_first

 No Yes 
185  94 

$comments

                                                                                                                                                                          
                                                                                                                                                                      160 
                                                                                                                            1st "hetman of ukraine", also military leader 
                                                                                                                                                                        1 
                                                                                                            1st author of detective novels and modern poetry in Ukrainian 
                                                                                                                                                                        1 
                                                                                                                 1st black state leader and 1st president of South Africa 
                                                                                                                                                                        5 
                                                                                                               1st Chairman of the People's Republic of China (1954–1959) 
                                                                                                                                                                        1 
                                                                                                                                             1st christian prince of Kiev 
                                                                                                                                                                        1 
                                                                                                                               1st climber to summit Mt Everest. explorer 
                                                                                                                                                                        1 
                                                                                                                 1st female minister in the independent Malawi government 
                                                                                                                                                                        1 
                                                                                                              1st Filipino graduate of the US Military Academy West Point 
                                                                                                                                                                        1 
                                                                                                                    1st Filipino head of gov't over the entire Philipines 
                                                                                                                                                                        1 
                                                                                                                             1st french-canadian prime minister of canada 
                                                                                                                                                                        1 
                                                                                                                                     1st indigeneous Governer of the Bank 
                                                                                                                                                                        1 
                                                                                                                                                 1st Indonesian president 
                                                                                                                                                                        1 
                                                                                                                                            1st Indonesian vice-president 
                                                                                                                                                                        1 
                                                                                                                      1st Maori to graduate from a New Zealand university 
                                                                                                                                                                        1 
                                                                                                                     1st Mexican to have their art featured in the Louvre 
                                                                                                                                                                        1 
                                                                                                                                          1st Premier of Northern Nigeria 
                                                                                                                                                                        1 
                                                                                                                           1st President and 1st Prime Minister of Malawi 
                                                                                                                                                                        1 
                                                                                                                                                 1st president of Bolivia 
                                                                                                                                                                        1 
                                                                                                                             1st president of Federal Republic of Nigeria 
                                                                                                                                                                        1 
                                                                                                                                  1st president of independent Philipines 
                                                                                                                                                                        1 
                                                                                              1st president of indigenous origin. also on the 20 pesos bill from Series F 
                                                                                                                                                                        2 
                                                                                                                                                     1st president of USA 
                                                                                                                                                                        1 
                                                                                                                                    1st prime minister after independence 
                                                                                                                                                                        1 
                                                                                                                                             1st prime minister of canada 
                                                                                                                                                                        1 
                                                                                                                                1st prime minister of independent Nigeria 
                                                                                                                                                                        1 
                                                                                                                                            1st secretary of the treasury 
                                                                                                                                                                        1 
                                                                                                                                                1st US secretary of state 
                                                                                                                                                                        1 
                                                                                          1st Visayan person to be president. 1st speaker of the House of Representatives 
                                                                                                                                                                        1 
                                                                      Alleged first person to build a liquid-propellant rocket engine and modern rocket propulsion system 
                                                                                                                                                                        1 
                                                                                                 also an author, president of Central Rada (Soviet) and national activist 
                                                                                                                                                                        1 
                                                                                                   also known for being politicaly active, but not holding elected office 
                                                                                                                                                                        1 
                                                                                                                                                also known for his poetry 
                                                                                                                                                                        1 
                                                                                                                                  also on the 50 pesos bill from Series F 
                                                                                                                                                                        1 
                                                                                                                                   Came up with the first Argentine flag. 
                                                                                                                                                                        1 
                                                                                                                                            Canada's first labor minister 
                                                                                                                                                                        1 
                                                                                                                                       cannot find info about this person 
                                                                                                                                                                        1 
                                                                                                                                   Composed music for the national anthem 
                                                                                                                                                                        1 
                                                                                                                      Composer. was part of Serbia's first string quartet 
                                                                                                                                                                        1 
                                                                                                                                             considered 1st national hero 
                                                                                                                                                                        1 
                                                                                                    elected "Hetman of Zaporizhian Host" . also served as military leader 
                                                                                                                                                                        1 
                                                                                               elected the first civilian Governor of Cross River State from 1979 to 1983 
                                                                                                                                                                        1 
                                                            entitled Datka (meaning "Righteous Ruler") of her people. also ran away from her first husband, which is rare 
                                                                                                                                                                        1 
                                                                                                                                     First catholic saint of the Americas 
                                                                                                                                                                        1 
                                                                                                                      First Colombian to win a Nobel Prize for Literature 
                                                                                                                                                                        1 
                                                                                                                                             First female Muslim novelist 
                                                                                                                                                                        1 
                                                                                                                                    First female president in Phillipines 
                                                                                                                                                                        1 
                                                                                                                       First King of Bohemia to become Holy Roman Emperor 
                                                                                                                                                                        1 
                                                                                                                        first modern tunisian woman to become a physician 
                                                                                                                                                                        1 
                                                                                                                                            First president of Cape Verde 
                                                                                                                                                                        1 
                                                                                                                                  First president of Colombia and Bolivia 
                                                                                                                                                                        1 
                                                                                                                                        First president of Czechoslovakia 
                                                                                                                                                                        1 
                                                                                                    First president of the Republic of New Granada (present-day Colombia) 
                                                                                                                                                                        1 
                                                                                                          First rector of Universidad de Chile. Wrote Chilean Civil Code. 
                                                                                                                                                                        1 
                                                                                      First to promote and write about free and universal elementary schooling in Uruguay 
                                                                                                                                                                        1 
                                                                                 first United States Postmaster General, first United States Ambassador to France, etc... 
                                                                                                                                                                        1 
                                                                                                                                   Founded Uruguay's first public library 
                                                                                                                                                                        1 
                                                                    Founder of Bangladesh who served as the first President and later as the Prime Minister of Bangladesh 
                                                                                                                                                                        9 
                                                                                                                 Founder of Georgia's first regular university in Tbilisi 
                                                                                                                                                                        1 
Founder of the country's first Montessori school. She was a co-founder of the Communist Party of Costa Rica, as well as one of the country's first female worker's unions 
                                                                                                                                                                        1 
                                                                                                                          Frst constitutionally elected leader of Bolivia 
                                                                                                                                                                        2 
                                                                                       Given the honorary title of "La Primera Mujer Congresista" by Adolfo Ruiz Cortines 
                                                                                                                                                                        1 
    He also wrote the first-ever programming manual, and his programming system was used in the Ferranti Mark I, the first marketable electronic digital computer (1951). 
                                                                                                                                                                        1 
                                                                                      he is on the face of all the banknotes. the other people are on the oppposite sides 
                                                                                                                                                                        6 
                                                                                                                                              known as Rachel the Poetess 
                                                                                                                                                                        1 
                                                                                known for campaigning for women's suffrage and founder of the girls scouts in phillipines 
                                                                                                                                                                        1 
                                                                                                      Known for organizing an uprising against the colonial British rule. 
                                                                                                                                                                        2 
                                                                                                                                                    leader of the Maroons 
                                                                                                                                                                        1 
                                                                                                           National Council of Women (NCW) and became its first president 
                                                                                                                                                                        1 
                                                                                                                                                            national hero 
                                                                                                                                                                        3 
                                                                                                       nobel prize winning author. also in the military and a politician. 
                                                                                                                                                                        1 
                                                                   organized meetings for slaves. hanged for expressing concerns about British rule that lead to a revolt 
                                                                                                                                                                        1 
                                                                                                                                            Shares face with other people 
                                                                                                                                                                        1 
                                                                                                     Shares face with other people. First Senator of First Nations origin 
                                                                                                                                                                        1 
                                                                                           Shares face with other people. The country's first female Member of Parliament 
                                                                                                                                                                        1 
                                                                                                                                               Shares with another person 
                                                                                                                                                                        2 
                                                                                                                               Shares with another person. businessperson 
                                                                                                                                                                        1 
                                                                        Shares with another person. Founded Royal Flying Doctor Service, the world's first air ambulance. 
                                                                                                                                                                        1 
      Shares with another person. In 1927 when his book of Aboriginal legends, Hurgarrda was published, he became the first Australian Aboriginal writer to be published. 
                                                                                                                                                                        1 
                            Shares with another person. She became the first person to be appointed Dame Commander of the British Empire for contributions to literature. 
                                                                                                                                                                        1 
                                                          Shares with another person. She is best known as the first Australian woman to serve as a member of parliament. 
                                                                                                                                                                        1 
                                                           Shares with another person. The first Australian to achieve international recognition as a classical musician. 
                                                                                                                                                                        1 
                                                                                                        She was Japan's first prominent woman writer of modern literature 
                                                                                                                                                                        1 
                                                                                                         She was South America's first ever Nobel Laureate in Literature. 
                                                                                                                                                                        1 
                                                                                                                     STEM. 1st person from Oceania to win the Nobel prize 
                                                                                                                                                                        1 
                                                                                                                            The first modern Icelandic short-story writer 
                                                                                                                                                                        1 
                                                                                                                         The first woman to rule Georgia in her own right 
                                                                                                                                                                        1 
                                                                                                                                              this might be legal tender. 
                                                                                                                                                                        1 
                                                                     was acting President and Commander-in-chief for a short time, and Chief Justice of the Supreme Court 
                                                                                                                                                                        1 
                                                                                                                    was governer of the national Bank of Serbia. explorer 
                                                                                                                                                                        1 
                                                                                                                                     was prime minister for only 2 months 
                                                                                                                                                                        1 
                                                                                                                                                Won the Nobel peace prize 
                                                                                                                                                                        1 
                                                                                                            writer, politician, diplomat and prime minister of Yugoslavia 
                                                                                                                                                                        1 
                                                                                                                                Wrote first lyrics to the national anthem 
                                                                                                                                                                        1 
                                                                                              wrote some of the most imporant Serbian literature. also a religious figure 
                                                                                                                                                                        1 
                                                                                                                wrote the 1st dictionary in the reformed Serbian language 
                                                                                                                                                                        1 
                                                                     Wrote the first Costa Rican General Code which set the foundations for the country's judicial system 
                                                                                                                                                                        1 

$hover_text

                                                                                                                                                      
                                                                                                                                                  190 
                                                  Alleged first person to build a liquid-propellant rocket engine and modern rocket propulsion system 
                                                                                                                                                    1 
                                                                                     Composed music for the national anthem to the Dominican Republic 
                                                                                                                                                    1 
                                                                                                            Considered first national hero of Nigeria 
                                                                                                                                                    1 
                                                                                                                        Designed first Argentine flag 
                                                                                                                                                    1 
                                                                                                   First Australian Aboriginal writer to be published 
                                                                                                                                                    1 
                                                                       First Australian to achieve international recognition as a classical musician. 
                                                                                                                                                    1 
                                                                                            First Australian woman to serve as a member of Parliament 
                                                                                                                                                    1 
                                                                                      First author of detective novels and modern poetry in Ukrainian 
                                                                                                                                                    1 
                                                                                         First Black state leader and first President of South Africa 
                                                                                                                                                    5 
                                                                                                                 First Catholic saint of the Americas 
                                                                                                                                                    1 
                                                                                                     First Chairman of the People's Republic of China 
                                                                                                                                                    6 
                                                                                                                       First Christian Prince of Kiev 
                                                                                                                                                    1 
                                                                                                         First civilian Governor of Cross River State 
                                                                                                                                                    1 
                                                                                                                   First climber to summit Mt Everest 
                                                                                                                                                    1 
                                                                                                  First Colombian to win a Nobel Prize for Literature 
                                                                                                                                                    1 
                                                                                                     First constitutionally elected leader of Bolivia 
                                                                                                                                                    2 
                                                                                                       First female member of the Canadian parliament 
                                                                                                                                                    1 
                                                                                           First female minister in the independent Malawi government 
                                                                                                                                                    1 
                                                                                                                         First female Muslim novelist 
                                                                                                                                                    1 
                                                                                                                First female president in Phillipines 
                                                                                                                                                    1 
                                                                                        First Filipino graduate of the US Military Academy West Point 
                                                                                                                                                    1 
                                                                                              First Filipino head of gov't over the entire Philipines 
                                                                                                                                                    1 
                                                                                                       First French-Canadian Prime Minister of Canada 
                                                                                                                                                    1 
                                                                                                      First indigeneous Governor of the Nigerian Bank 
                                                                                                                                                    1 
                                                                                                                           First Indonesian President 
                                                                                                                                                    1 
                                                                                                                      First Indonesian Vice-President 
                                                                                                                                                    1 
                                                                                                   First King of Bohemia to become Holy Roman Emperor 
                                                                                                                                                    1 
                                                                                                                       First Labor Minister in Canada 
                                                                                                                                                    1 
                                                                                                First Maori to graduate from a New Zealand university 
                                                                                                                                                    1 
                                                                                                         First Mexican President of indigenous origin 
                                                                                                                                                    2 
                                                                                               First Mexican to have their art featured in the Louvre 
                                                                                                                                                    1 
                                                                                                            First modern Icelandic short-story writer 
                                                                                                                                                    1 
                                                                                                    First modern Tunisian woman to become a physician 
                                                                                                                                                    1 
                                                          First person appointed Dame Commander of the British Empire for contributions to literature 
                                                                                                                                                    1 
                                                                                                       First person from Oceania to win a Nobel prize 
                                                                                                                                                    1 
                                                                                                                    First Premier of Northern Nigeria 
                                                                                                                                                    1 
                                                                                                         First President and Prime Minister of Malawi 
                                                                                                                                                    1 
                                                                                                                        First President of Bangladesh 
                                                                                                                                                    9 
                                                                                                                           First President of Bolivia 
                                                                                                                                                    1 
                                                                                                                        First President of Cape Verde 
                                                                                                                                                    1 
                                                                                                              First President of Colombia and Bolivia 
                                                                                                                                                    1 
                                                                                                                    First President of Czechoslovakia 
                                                                                                                                                    1 
                                                                                                       First President of Federal Republic of Nigeria 
                                                                                                                                                    1 
                                                                                                            First President of independent Philipines 
                                                                                                                                                    1 
                                                                                First president of the Republic of New Granada (present-day Colombia) 
                                                                                                                                                    1 
                                                                                                              First Prime Minister after independence 
                                                                                                                                                    1 
                                                                                                                       First Prime Minister of Canada 
                                                                                                                                                    1 
                                                                                                          First Prime Minister of independent Nigeria 
                                                                                                                                                    1 
                                                                                                                 First rector of Universidad de Chile 
                                                                                                                                                    1 
                                                                                                                First Senator of First Nations origin 
                                                                                                                                                    1 
                                                                  First to promote and write about free and universal elementary schooling in Uruguay 
                                                                                                                                                    1 
                                                                                First US Postmaster General, First United States Ambassador to France 
                                                                                                                                                    1 
                                                                                                                                   First US President 
                                                                                                                                                    1 
                                                                                                                          First US Secretary of State 
                                                                                                                                                    1 
                                                                                                                   First US Secretary of the Treasury 
                                                                                                                                                    1 
                                                    First Visayan person to be President of Philipines. First Speaker of the House of Representatives 
                                                                                                                                                    1 
                                                                               Founded National Council of Women (NCW) and became its first president 
                                                                                                                                                    1 
                                                                                 Founded Royal Flying Doctor Service, the world's first air ambulance 
                                                                                                                                                    1 
                                                                                                               Founded Uruguay's first public library 
                                                                                                                                                    1 
                                                                                                      Founder of Costa Rica's first Montessori school 
                                                                                                                                                    1 
                                                                                             Founder of Georgia's first regular university in Tbilisi 
                                                                                                                                                    1 
                                                                   Given the honorary title of "La Primera Mujer Congresista" by Adolfo Ruiz Cortines 
                                                                                                                                                    1 
                                                                                           Japan's first prominent female writer of modern literature 
                                                                                                                                                    1 
                                                                                                              Member of Serbia's first string quartet 
                                                                                                                                                    1 
                                                                                              South America's first ever Nobel Laureate in Literature 
                                                                                                                                                    1 
                                                                                                     The first woman to rule Georgia in her own right 
                                                                                                                                                    1 
                                                                                  Wrote first lyrics to the national anthem to the Dominican Republic 
                                                                                                                                                    1 
                                                 Wrote the first Costa Rican General Code which set the foundations for the country's judicial system 
                                                                                                                                                    1 
                                                                                          Wrote the first dictionary in the reformed Serbian language 
                                                                                                                                                    1 
Wrote the first-ever programming manual, and his programming system was used in the Ferranti Mark I, the first marketable electronic digital computer 
                                                                                                                                                    1 

$has_portrait

false  true 
  155   124 

$id

   ARS_Argentino     ARS_Belgrano      ARS_Domingo        ARS_Evita 
               1                1                1                1 
       ARS_Rosas        AUD_Banjo        AUD_Edith    AUD_Elizabeth 
               1                1                1                7 
       AUD_Flynn      AUD_Gilmore       AUD_Monash       AUD_Nellie 
               1                1                1                1 
      AUD_Reibey      AUD_Unaipon       BDT_Rahman        BOB_Alejo 
               1                1                9                1 
     BOB_Azurduy    BOB_Bartolina      BOB_Bolivar        BOB_Bruno 
               1                1                2                1 
      BOB_Canoto   BOB_Eustaquino      BOB_Ignacio       BOB_Katari 
               1                1                1                1 
        BOB_Rios       BOB_Santos        BOB_Sucre         BOB_Tupa 
               1                1                2                1 
       BOB_Tupac       BOB_Zarate        CAD_Agnes       CAD_Borden 
               1                1                1                1 
     CAD_Cartier    CAD_Gladstone      CAD_Laurier         CAD_Lyon 
               1                1                1                1 
   CAD_Macdonald        CAD_Viola       CLP_Andres       CLP_Chacon 
               1                1                1                1 
     CLP_Erdoyza      CLP_Ignacio      CLP_Mistral      COP_Alfonso 
               1                1                1                1 
    COP_Asuncion       COP_Debora      COP_Gabriel       COP_Gaitan 
               1                1                1                1 
    COP_Garavito       COP_Isaacs       COP_Lleras    COP_Policarpa 
               1                1                1                1 
   COP_Santander     COP_Virginia        CRC_Acuna     CRC_Carrillo 
               1                1                1                1 
    CRC_Carvajal     CRC_Figueres     CRC_Gonzalez      CRC_Ricardo 
               1                1                1                1 
     CVE_Barbosa      CVE_Cesaria         CVE_Code     CVE_Henrique 
               1                1                1                1 
     CVE_Pereira         CZK_Amos       CZK_Bozena      CZK_Charles 
               1                1                1                1 
         CZK_Ema    CZK_Frantisek     CZK_Garrigue       DOP_Duarte 
               1                1                1                1 
      DOP_Emilio      DOP_Luperon        DOP_Maria       DOP_Matias 
               1                1                1                1 
     DOP_Minerva       DOP_Patria      DOP_Rosario       DOP_Rufino 
               1                1                1                1 
      DOP_Salome        DOP_Urena       GBP_Austen    GBP_Churchill 
               1                1                1                1 
      GBP_Turing       GBP_Turner        GEL_Akaki        GEL_David 
               1                1                1                1 
        GEL_Ilia        GEL_Ivane      GEL_Kakutsa         GEL_Niko 
               1                1                1                1 
       GEL_Shota        GEL_Tamar      GEL_Zakaria      IDR_Djuanda 
               1                1                1                1 
       IDR_Frans         IDR_GSSJ        IDR_Gusti        IDR_Hatta 
               1                1                1                1 
       IDR_Husni        IDR_Idham          IDR_Oto       IDR_Prince 
               1                1                1                1 
    IDR_Soekarno       IDR_Sultan         IDR_Tjut     ILS_Goldberg 
               1                1                1                1 
      ILS_Nathan       ILS_Rachel        ILS_Shaul ISK_Hallgrimsson 
               1                1                1                1 
     ISK_Kjarval   ISK_Ragnheiour   ISK_Sigurdsson    ISK_Sveinsson 
               1                1                1                1 
        JMD_Hugh        JMD_Nanny       JMD_Norman     JMD_Sangster 
               1                1                1                1 
      JMD_Sharpe       JPY_Hideyo       JPY_Ichiyo      JPY_Yukichi 
               1                1                1                1 
   KGS_Balasagyn        KGS_Datka      KGS_Osmonov     KGS_Sayakbay 
               1                1                1                1 
   KGS_Suymonkul      KGS_Togolok     KGS_Toktogul        KRW_Hwang 
               1                1                1                1 
           KRW_I       KRW_Sejong         KRW_Shin    MWK_Chilembwe 
               1                1                1                2 
      MWK_Gomani     MWK_Hastings      MWK_Mmbelwa         MWK_Rose 
               1                1                1                1 
     MWK_Sangala       MXN_Benito        MXN_Frida      MXN_Hermila 
               1                2                1                1 
     MXN_Hidalgo        MXN_Juana       MXN_Madero      MXN_Morelos 
               1                1                1                1 
        MXN_Neza       MXN_Rivera       MXN_Serdan        NGN_Aliyu 
               1                1                1                1 
       NGN_Alvan       NGN_Balewa        NGN_Bello      NGN_Clement 
               1                1                1                1 
       NGN_Kwali      NGN_Murtala       NGN_Nnamdi      NGN_Obafemi 
               1                1                1                1 
      NZD_Edmund        NZD_Ngata   NZD_Rutherford     NZD_Sheppard 
               1                1                1                1 
    PEN_Abelardo      PEN_Basadre       PEN_Granda       PEN_Paulet 
               1                1                1                1 
       PEN_Pinto         PEN_Raul        PEN_Santa       PGK_Somare 
               1                1                1                1 
        PHP_Abad      PHP_Benigno      PHP_Corazon     PHP_Diosdado 
               1                1                1                1 
      PHP_Llanes       PHP_Osmena       PHP_Quezon        PHP_Roxas 
               1                1                1                1 
     PHP_Vicente          RMB_Mao       RSD_Cvijic        RSD_Dorde 
               1                6                1                1 
     RSD_Milutin       RSD_Njegos     RSD_Petrovic     RSD_Slobodan 
               1                1                1                1 
  RSD_Stevanovic        RSD_Tesla          RSD_Vuk          SEK_Dag 
               1                1                1                1 
       SEK_Evert        SEK_Greta       SEK_Ingmar     SEK_Lindgren 
               1                1                1                1 
     SEK_Nilsson          STD_Rei     STD_Tenreiro       TND_Chebbi 
               1                7                1                1 
      TND_Farhat     TND_Hannibal      TND_Tewhida          TRY_Arf 
               1                1                1                1 
     TRY_Ataturk        TRY_Fatma         TRY_Itri   TRY_Kemaleddin 
               6                1                1                1 
      TRY_Sayili        TRY_Yunus       UAH_Bogdon       UAH_Franko 
               1                1                1                1 
       UAH_Great       UAH_Mazepa     UAH_Mykhailo    UAH_Skovoroda 
               1                1                1                1 
       UAH_Taras     UAH_Ukrainka   UAH_Vernadskyi     UAH_Yaroslav 
               1                1                1                1 
    USD_Franklin     USD_Hamilton      USD_Jackson    USD_Jefferson 
               1                1                1                1 
     USD_Lincoln      USD_Ulysses   USD_Washington      UYU_Eduardo 
               1                1                1                1 
      UYU_Figari   UYU_Ibarbourou    UYU_Larranaga       UYU_Varela 
               1                1                1                1 
     UYU_Vasquez     UYU_Zorrilla       VES_Camejo     VES_Ezequiel 
               1                1                1                1 
     VES_Miranda       VES_Rajael        VES_Ribas    VES_Rodrigues 
               1                1                1                1 
     ZAR_Mandela 
               5 </code></pre>
</div>
</div>
<p>We use <code>lapply</code> rather than <code>sapply</code> for this step because the table for each column will have a different length (but try <code>sapply</code> and see what happens!).</p>
</section>
<section id="the-split-apply-pattern" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="the-split-apply-pattern"><span class="header-section-number">3.4.2</span> The Split-Apply Pattern</h3>
<p>In a data set with categorical features, it’s often useful to compute something for each category. The <code>lapply</code> and <code>sapply</code> functions can compute something for each element of a data structure, but categories are not necessarily elements.</p>
<p>For example, the banknotes data set has 38 different categories in the <code>country</code> column. If we want all of the rows for one country, one way to get them is by indexing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>usa <span class="ot">=</span> banknotes[banknotes<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"United States"</span>, ]</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(usa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    currency_code       country currency_name              name gender
253           USD United States     US dollar  Ulysses S. Grant      M
254           USD United States     US dollar  Thomas Jefferson      M
255           USD United States     US dollar   Abraham Lincoln      M
256           USD United States     US dollar George Washington      M
257           USD United States     US dollar    Andrew Jackson      M
258           USD United States     US dollar Benjamin Franklin      M
    bill_count    profession known_for_being_first current_bill_value
253          1 Head of Gov't                    No                 50
254          1       Founder                   Yes                  2
255          1 Head of Gov't                    No                  5
256          1       Founder                   Yes                  1
257          1 Head of Gov't                    No                 20
258          1       Founder                   Yes                100
    prop_total_bills first_appearance_year death_year
253             0.05                  1913       1885
254             0.03                  1869       1826
255             0.06                  1914       1865
256             0.26                  1869       1799
257             0.23                  1928       1845
258             0.33                  1914       1790
                                                                                    comments
253                                                                                         
254                                                                1st US secretary of state
255                                                                                         
256                                                                     1st president of USA
257                                                                                         
258 first United States Postmaster General, first United States Ambassador to France, etc...
                                                               hover_text
253                                                                      
254                                           First US Secretary of State
255                                                                      
256                                                    First US President
257                                                                      
258 First US Postmaster General, First United States Ambassador to France
    has_portrait             id scaled_bill_value
253         true    USD_Ulysses        0.49494949
254         true  USD_Jefferson        0.01010101
255         true    USD_Lincoln        0.04040404
256         true USD_Washington        0.00000000
257        false    USD_Jackson        0.19191919
258         true   USD_Franklin        1.00000000</code></pre>
</div>
</div>
<p>To get all 38 countries separately, we’d have to do this 38 times. If we want to compute something for each country, say the mean of the <code>first_appearance_year</code> column, we also have to repeat that computation 38 times. Here’s what it would look like for just the United States:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(usa<span class="sc">$</span>first_appearance_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1905.143</code></pre>
</div>
</div>
<p>If the categories were elements, we could avoid writing code to index each category, and just use the <code>sapply</code> (or <code>lapply</code>) function to apply the <code>mean</code> function to each.</p>
<p>The <code>split</code> function splits a vector or data frame into groups based on a vector of categories. The first argument to <code>split</code> is the data, and the second argument is a congruent vector of categories.</p>
<p>We can use <code>split</code> to elegantly compute means of <code>first_appearance_year</code> broken down by country. First, we split the data by country. Since we only want to compute on the <code>first_appearance_year</code> column, we only split that column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>by_country <span class="ot">=</span> <span class="fu">split</span>(banknotes<span class="sc">$</span>first_appearance_year, banknotes<span class="sc">$</span>country)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(by_country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(by_country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Argentina"             "Australia"             "Bangladesh"           
 [4] "Bolivia"               "Canada"                "Cape Verde"           
 [7] "Chile"                 "China"                 "Colombia"             
[10] "Costa Rica"            "Czech Republic"        "Dominican Republic"   
[13] "England"               "Georgia"               "Iceland"              
[16] "Indonesia"             "Israel"                "Jamaica"              
[19] "Japan"                 "Kyrgyzstan"            "Malawi"               
[22] "Mexico"                "New Zealand"           "Nigeria"              
[25] "Papua New Guinea"      "Peru"                  "Philippines"          
[28] "São Tomé and Príncipe" "Serbia"                "South Africa"         
[31] "South Korea"           "Sweden"                "Tunisia"              
[34] "Turkey"                "Ukraine"               "United States"        
[37] "Uruguay"               "Venezuela"            </code></pre>
</div>
</div>
<p>The result from <code>split</code> is a list with one element for each category. The individual elements contain pieces of the original <code>first_appearance_year</code> column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(by_country<span class="sc">$</span>Mexico)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2010 2010 1979 2020 2020 1973</code></pre>
</div>
</div>
<p>Since the categories are elements in the split data, now we can use <code>sapply</code> the same way we did in previous examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(by_country, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Argentina             Australia            Bangladesh 
             1992.200              1990.778              1972.000 
              Bolivia                Canada            Cape Verde 
             2010.667              1983.778              2014.000 
                Chile                 China              Colombia 
             1988.600              1980.000              2001.727 
           Costa Rica        Czech Republic    Dominican Republic 
             2002.667              1993.500              1991.545 
              England               Georgia               Iceland 
             1994.000              1997.222              1991.800 
            Indonesia                Israel               Jamaica 
             2004.750              2015.750              1989.000 
                Japan            Kyrgyzstan                Malawi 
             1997.333              1998.714              2001.857 
               Mexico           New Zealand               Nigeria 
             1988.545              1987.000              1994.667 
     Papua New Guinea                  Peru           Philippines 
             1989.000              2000.143              1982.111 
São Tomé and Príncipe                Serbia          South Africa 
             1981.500              2005.111              2012.000 
          South Korea                Sweden               Tunisia 
             1982.250              2015.167              2015.750 
               Turkey               Ukraine         United States 
             1968.000              1997.000              1905.143 
              Uruguay             Venezuela 
             1998.429              1991.500 </code></pre>
</div>
</div>
<p>This two-step process is an R idiom called the <em>split-apply pattern</em>. First you use <code>split</code> to convert categories into list elements, then you use an apply function to compute something on each category. Any time you want to compute results by category, you should think of this pattern.</p>
<p>The split-apply pattern is so useful that R provides the <code>tapply</code> function as a shortcut. The <code>tapply</code> function is equivalent to calling <code>split</code> and then <code>sapply</code>. Like <code>split</code>, the first argument is the data and the second argument is a congruent vector of categories. The third argument is a function to apply, like the function argument in <code>sapply</code>.</p>
<p>We can use <code>tapply</code> to compute the <code>first_appearance_year</code> means by <code>country</code> for the banknotes data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(banknotes<span class="sc">$</span>first_appearance_year, banknotes<span class="sc">$</span>country, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Argentina             Australia            Bangladesh 
             1992.200              1990.778              1972.000 
              Bolivia                Canada            Cape Verde 
             2010.667              1983.778              2014.000 
                Chile                 China              Colombia 
             1988.600              1980.000              2001.727 
           Costa Rica        Czech Republic    Dominican Republic 
             2002.667              1993.500              1991.545 
              England               Georgia               Iceland 
             1994.000              1997.222              1991.800 
            Indonesia                Israel               Jamaica 
             2004.750              2015.750              1989.000 
                Japan            Kyrgyzstan                Malawi 
             1997.333              1998.714              2001.857 
               Mexico           New Zealand               Nigeria 
             1988.545              1987.000              1994.667 
     Papua New Guinea                  Peru           Philippines 
             1989.000              2000.143              1982.111 
São Tomé and Príncipe                Serbia          South Africa 
             1981.500              2005.111              2012.000 
          South Korea                Sweden               Tunisia 
             1982.250              2015.167              2015.750 
               Turkey               Ukraine         United States 
             1968.000              1997.000              1905.143 
              Uruguay             Venezuela 
             1998.429              1991.500 </code></pre>
</div>
</div>
<p>Notice that the result is identical to the one we computed before.</p>
<p>The “t” in <code>tapply</code> stands for “table”, because the <code>tapply</code> function is a generalization of the <code>table</code> function. If you use <code>length</code> as the third argument to <code>tapply</code>, you get the same results as you would from using the <code>table</code> function on the category vector.</p>
<p>The <code>aggregate</code> function is closely related to <code>tapply</code>. It computes the same results, but organizes them into a data frame with one row for each category. In some cases, this format is more convenient. The arguments are the same, except that the second argument must be a list or data frame rather than a vector.</p>
<p>As an example, here’s the result of using <code>aggregate</code> to compute the <code>first_appearance_year</code> means:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(banknotes<span class="sc">$</span>first_appearance_year, <span class="fu">list</span>(banknotes<span class="sc">$</span>country), mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Group.1        x
1              Argentina 1992.200
2              Australia 1990.778
3             Bangladesh 1972.000
4                Bolivia 2010.667
5                 Canada 1983.778
6             Cape Verde 2014.000
7                  Chile 1988.600
8                  China 1980.000
9               Colombia 2001.727
10            Costa Rica 2002.667
11        Czech Republic 1993.500
12    Dominican Republic 1991.545
13               England 1994.000
14               Georgia 1997.222
15               Iceland 1991.800
16             Indonesia 2004.750
17                Israel 2015.750
18               Jamaica 1989.000
19                 Japan 1997.333
20            Kyrgyzstan 1998.714
21                Malawi 2001.857
22                Mexico 1988.545
23           New Zealand 1987.000
24               Nigeria 1994.667
25      Papua New Guinea 1989.000
26                  Peru 2000.143
27           Philippines 1982.111
28 São Tomé and Príncipe 1981.500
29                Serbia 2005.111
30          South Africa 2012.000
31           South Korea 1982.250
32                Sweden 2015.167
33               Tunisia 2015.750
34                Turkey 1968.000
35               Ukraine 1997.000
36         United States 1905.143
37               Uruguay 1998.429
38             Venezuela 1991.500</code></pre>
</div>
</div>
<p>The <code>lapply</code>, <code>sapply</code>, and <code>tapply</code> functions are the three most important functions in the family of apply functions, but there are many more. You can learn more about all of R’s apply functions by reading <a href="https://stackoverflow.com/a/7141669">this StackOverflow post</a>.</p>
</section>
</section>
<section id="exercises" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="exercises"><span class="header-section-number">3.5</span> Exercises</h2>
<section id="exercise" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="exercise"><span class="header-section-number">3.5.1</span> Exercise</h3>
<p>Compute the number of banknotes that feature a person who died before 1900.</p>
</section>
<section id="exercise-1" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="exercise-1"><span class="header-section-number">3.5.2</span> Exercise</h3>
<p>Compute the range of <code>first_appearance_year</code> for each country.</p>
</section>
<section id="exercise-2" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="exercise-2"><span class="header-section-number">3.5.3</span> Exercise</h3>
<ol type="1">
<li><p>Compute the set of banknotes with people who died in this century.</p>
<p><em>Hint: be careful of missing values in the <code>death_year</code> column!</em></p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>is21 <span class="ot">=</span> <span class="sc">!</span><span class="fu">is.na</span>(banknotes<span class="sc">$</span>death_year) <span class="sc">&amp;</span> banknotes<span class="sc">$</span>death_year <span class="sc">&gt;=</span> <span class="dv">2000</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>people21 <span class="ot">=</span> banknotes[is21, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li><p>Use ggplot2’s <code>geom_segment</code> function to create a plot which shows the timespan between death year and first appearance as a horizontal segment, for each banknote in the result from step 1. Put the name of each person on the y-axis. Color code the segments by gender.</p>
<p><em>Hint: You can make the plot more visually appealing if you first sort the data by death year. You can use the <code>order</code> function to get indexes that will sort the rows of a data frame according to some column.</em></p></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/02_data-structures.html" class="pagination-link" aria-label="Data Structures">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Structures</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/04_organizing_code.html" class="pagination-link" aria-label="Organizing Code">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Organizing Code</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>